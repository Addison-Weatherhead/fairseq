DEBUG:hydra.core.utils:Setting JobRuntime:name=UNKNOWN_NAME
DEBUG:hydra.core.utils:Setting JobRuntime:name=hydra_train
DEBUG:hydra.core.utils:Setting JobRuntime:name=UNKNOWN_NAME
DEBUG:hydra.core.utils:Setting JobRuntime:name=hydra_train
DEBUG:hydra.core.utils:Setting JobRuntime:name=UNKNOWN_NAME
DEBUG:hydra.core.utils:Setting JobRuntime:name=hydra_train
DEBUG:hydra.core.utils:Setting JobRuntime:name=UNKNOWN_NAME
DEBUG:hydra.core.utils:Setting JobRuntime:name=hydra_train
[2024-04-23 21:30:08,267][HYDRA] Launching 1 jobs locally
[2024-04-23 21:30:08,267][HYDRA] 	#0 : distributed_training.distributed_world_size=4 +trainer.tensorboard_logdir=/h/addisonw/fairseq/logs/tb/ task.data=/h/addisonw/fairseq/manifests/finetuning_data10h model.w2v_path=/h/addisonw/fairseq/pretrained_models/base_libri.pt common.user_dir=examples/data2vec
[2024-04-23 21:30:08,277][HYDRA] Launching 1 jobs locally
[2024-04-23 21:30:08,277][HYDRA] 	#0 : distributed_training.distributed_world_size=4 +trainer.tensorboard_logdir=/h/addisonw/fairseq/logs/tb/ task.data=/h/addisonw/fairseq/manifests/finetuning_data10h model.w2v_path=/h/addisonw/fairseq/pretrained_models/base_libri.pt common.user_dir=examples/data2vec
[2024-04-23 21:30:08,484][HYDRA] Launching 1 jobs locally
[2024-04-23 21:30:08,484][HYDRA] Launching 1 jobs locally
[2024-04-23 21:30:08,484][HYDRA] 	#0 : distributed_training.distributed_world_size=4 +trainer.tensorboard_logdir=/h/addisonw/fairseq/logs/tb/ task.data=/h/addisonw/fairseq/manifests/finetuning_data10h model.w2v_path=/h/addisonw/fairseq/pretrained_models/base_libri.pt common.user_dir=examples/data2vec
[2024-04-23 21:30:08,484][HYDRA] 	#0 : distributed_training.distributed_world_size=4 +trainer.tensorboard_logdir=/h/addisonw/fairseq/logs/tb/ task.data=/h/addisonw/fairseq/manifests/finetuning_data10h model.w2v_path=/h/addisonw/fairseq/pretrained_models/base_libri.pt common.user_dir=examples/data2vec
HYDRA CONFIG:
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 50, 'log_format': json, 'log_file': '/h/addisonw/fairseq/logs/gaussianNoise/log.json', 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': 'examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 4, 'distributed_num_procs': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': legacy_ddp, 'ddp_comm_hook': none, 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': never, 'zero_sharding': none, 'fp16': '${common.fp16}', 'memory_efficient_fp16': '${common.memory_efficient_fp16}', 'tpu': '${common.tpu}', 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1280000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': '${dataset.max_tokens}', 'batch_size_valid': '${dataset.batch_size}', 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': '${dataset.grouped_shuffling}', 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 20000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': True, 'update_freq': [5], 'lr': [0.0001], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': '/h/addisonw/fairseq/checkpoints/gaussianNoise', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 5, 'save_interval_updates': 10000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'wer', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': '${common.model_parallel_size}'}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': '${distributed_training.distributed_world_size}'}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'apply_mask': True, 'mask_prob': 0.75, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'layerdrop': 0.1, 'activation_dropout': 0.1, 'feature_grad_mult': 0.0, 'freeze_finetune_updates': 10000}, 'task': {'_name': 'audio_finetuning', 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'normalize': True, 'labels': 'ltr', 'eval_wer': True}, 'criterion': {'_name': 'ctc', 'zero_infinity': True, 'wer_kenlm_model': '/h/addisonw/fairseq/pretrained_models/kenlm/4-gram.bin', 'wer_lexicon': '/h/addisonw/fairseq/pretrained_models/kenlm/lexicon.txt', 'wer_lm_weight': 2, 'wer_word_score': -1}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08}, 'lr_scheduler': {'_name': 'tri_stage', 'phase_ratio': [0.1, 0.4, 0.5], 'final_lr_scale': 0.05}, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'trainer': {'tensorboard_logdir': '/h/addisonw/fairseq/logs/tb/'}}
[2024-04-23 21:30:10,857][fairseq.distributed.utils][INFO] - Rank 3, device_id: 3
[2024-04-23 21:30:10,859][fairseq.distributed.utils][INFO] - setting CUDA device=3 on rank 3
HYDRA CONFIG:
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 50, 'log_format': json, 'log_file': '/h/addisonw/fairseq/logs/gaussianNoise/log.json', 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': 'examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 4, 'distributed_num_procs': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': legacy_ddp, 'ddp_comm_hook': none, 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': never, 'zero_sharding': none, 'fp16': '${common.fp16}', 'memory_efficient_fp16': '${common.memory_efficient_fp16}', 'tpu': '${common.tpu}', 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1280000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': '${dataset.max_tokens}', 'batch_size_valid': '${dataset.batch_size}', 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': '${dataset.grouped_shuffling}', 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 20000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': True, 'update_freq': [5], 'lr': [0.0001], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': '/h/addisonw/fairseq/checkpoints/gaussianNoise', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 5, 'save_interval_updates': 10000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'wer', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': '${common.model_parallel_size}'}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': '${distributed_training.distributed_world_size}'}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'apply_mask': True, 'mask_prob': 0.75, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'layerdrop': 0.1, 'activation_dropout': 0.1, 'feature_grad_mult': 0.0, 'freeze_finetune_updates': 10000}, 'task': {'_name': 'audio_finetuning', 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'normalize': True, 'labels': 'ltr', 'eval_wer': True}, 'criterion': {'_name': 'ctc', 'zero_infinity': True, 'wer_kenlm_model': '/h/addisonw/fairseq/pretrained_models/kenlm/4-gram.bin', 'wer_lexicon': '/h/addisonw/fairseq/pretrained_models/kenlm/lexicon.txt', 'wer_lm_weight': 2, 'wer_word_score': -1}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08}, 'lr_scheduler': {'_name': 'tri_stage', 'phase_ratio': [0.1, 0.4, 0.5], 'final_lr_scale': 0.05}, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'trainer': {'tensorboard_logdir': '/h/addisonw/fairseq/logs/tb/'}}
[2024-04-23 21:30:10,867][fairseq.distributed.utils][INFO] - Rank 0, device_id: 0
[2024-04-23 21:30:11,143][fairseq.distributed.utils][INFO] - distributed init (rank 3): tcp://localhost:49623
HYDRA CONFIG:
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 50, 'log_format': json, 'log_file': '/h/addisonw/fairseq/logs/gaussianNoise/log.json', 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': 'examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 4, 'distributed_num_procs': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': legacy_ddp, 'ddp_comm_hook': none, 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': never, 'zero_sharding': none, 'fp16': '${common.fp16}', 'memory_efficient_fp16': '${common.memory_efficient_fp16}', 'tpu': '${common.tpu}', 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1280000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': '${dataset.max_tokens}', 'batch_size_valid': '${dataset.batch_size}', 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': '${dataset.grouped_shuffling}', 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 20000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': True, 'update_freq': [5], 'lr': [0.0001], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': '/h/addisonw/fairseq/checkpoints/gaussianNoise', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 5, 'save_interval_updates': 10000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'wer', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': '${common.model_parallel_size}'}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': '${distributed_training.distributed_world_size}'}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'apply_mask': True, 'mask_prob': 0.75, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'layerdrop': 0.1, 'activation_dropout': 0.1, 'feature_grad_mult': 0.0, 'freeze_finetune_updates': 10000}, 'task': {'_name': 'audio_finetuning', 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'normalize': True, 'labels': 'ltr', 'eval_wer': True}, 'criterion': {'_name': 'ctc', 'zero_infinity': True, 'wer_kenlm_model': '/h/addisonw/fairseq/pretrained_models/kenlm/4-gram.bin', 'wer_lexicon': '/h/addisonw/fairseq/pretrained_models/kenlm/lexicon.txt', 'wer_lm_weight': 2, 'wer_word_score': -1}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08}, 'lr_scheduler': {'_name': 'tri_stage', 'phase_ratio': [0.1, 0.4, 0.5], 'final_lr_scale': 0.05}, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'trainer': {'tensorboard_logdir': '/h/addisonw/fairseq/logs/tb/'}}
[2024-04-23 21:30:11,204][fairseq.distributed.utils][INFO] - Rank 2, device_id: 2
[2024-04-23 21:30:11,205][fairseq.distributed.utils][INFO] - setting CUDA device=2 on rank 2
HYDRA CONFIG:
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 50, 'log_format': json, 'log_file': '/h/addisonw/fairseq/logs/gaussianNoise/log.json', 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': 'examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 4, 'distributed_num_procs': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': False, 'ddp_backend': legacy_ddp, 'ddp_comm_hook': none, 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': never, 'zero_sharding': none, 'fp16': '${common.fp16}', 'memory_efficient_fp16': '${common.memory_efficient_fp16}', 'tpu': '${common.tpu}', 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1280000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': '${dataset.max_tokens}', 'batch_size_valid': '${dataset.batch_size}', 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': '${dataset.grouped_shuffling}', 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 20000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': True, 'update_freq': [5], 'lr': [0.0001], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': '/h/addisonw/fairseq/checkpoints/gaussianNoise', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 5, 'save_interval_updates': 10000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'wer', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': '${common.model_parallel_size}'}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': '${distributed_training.distributed_world_size}'}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'apply_mask': True, 'mask_prob': 0.75, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'layerdrop': 0.1, 'activation_dropout': 0.1, 'feature_grad_mult': 0.0, 'freeze_finetune_updates': 10000}, 'task': {'_name': 'audio_finetuning', 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'normalize': True, 'labels': 'ltr', 'eval_wer': True}, 'criterion': {'_name': 'ctc', 'zero_infinity': True, 'wer_kenlm_model': '/h/addisonw/fairseq/pretrained_models/kenlm/4-gram.bin', 'wer_lexicon': '/h/addisonw/fairseq/pretrained_models/kenlm/lexicon.txt', 'wer_lm_weight': 2, 'wer_word_score': -1}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08}, 'lr_scheduler': {'_name': 'tri_stage', 'phase_ratio': [0.1, 0.4, 0.5], 'final_lr_scale': 0.05}, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'trainer': {'tensorboard_logdir': '/h/addisonw/fairseq/logs/tb/'}}
[2024-04-23 21:30:11,237][fairseq.distributed.utils][INFO] - Rank 1, device_id: 1
[2024-04-23 21:30:11,238][fairseq.distributed.utils][INFO] - setting CUDA device=1 on rank 1
[2024-04-23 21:30:11,410][fairseq.distributed.utils][INFO] - distributed init (rank 2): tcp://localhost:49623
[2024-04-23 21:30:11,479][fairseq.distributed.utils][INFO] - distributed init (rank 1): tcp://localhost:49623
[2024-04-23 21:30:14,132][fairseq.distributed.utils][INFO] - distributed init (rank 0): tcp://localhost:49623
[2024-04-23 21:30:14,152][fairseq.distributed.utils][INFO] - initialized host gpu101 as rank 3
[2024-04-23 21:30:14,419][fairseq.distributed.utils][INFO] - initialized host gpu101 as rank 2
[2024-04-23 21:30:14,488][fairseq.distributed.utils][INFO] - initialized host gpu101 as rank 1
[2024-04-23 21:30:14,489][fairseq.distributed.utils][INFO] - initialized host gpu101 as rank 0
ENTERED MAIN
Python path: ['/fs01/home/addisonw/fairseq/fairseq_cli', '/h/addisonw/fairseq', '/fs01/home/addisonw/fairseq', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python38.zip', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/lib-dynload', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/site-packages']
[2024-04-23 21:30:23,208][fairseq_cli.train][INFO] - {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 50, 'log_format': 'json', 'log_file': '/h/addisonw/fairseq/logs/gaussianNoise/log.json', 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': 'examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 4, 'distributed_num_procs': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:49623', 'distributed_port': 49623, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1280000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 1280000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 20000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': True, 'update_freq': [5], 'lr': [0.0001], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': '/h/addisonw/fairseq/checkpoints/gaussianNoise', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 5, 'save_interval_updates': 10000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'wer', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': None, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}, 'task': {'_name': 'audio_finetuning', 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'labels': 'ltr', 'multi_corpus_keys': None, 'multi_corpus_sampling_weights': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': None, 'min_sample_size': None, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': none, 'rebuild_batches': True, 'precompute_mask_config': None, 'post_save_script': None, 'subsample': 1.0, 'seed': 1, 'eval_wer': True, 'add_gaussian_train_noise': False, 'add_uniform_train_noise': False, 'eval_wer_config': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_wer_tokenizer': None, 'eval_wer_post_process': 'letter', 'eval_bleu': False, 'eval_bleu_detok': None, 'eval_bleu_detok_args': '{}', 'eval_tokenized_bleu': False, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': '{}', 'eval_bleu_print_samples': False, 'autoregressive': False, 'target_dictionary': None}, 'criterion': {'_name': 'ctc', 'zero_infinity': True, 'sentence_avg': True, 'post_process': 'letter', 'wer_kenlm_model': '/h/addisonw/fairseq/pretrained_models/kenlm/4-gram.bin', 'wer_lexicon': '/h/addisonw/fairseq/pretrained_models/kenlm/lexicon.txt', 'wer_lm_weight': 2.0, 'wer_word_score': -1.0, 'wer_sil_weight': 0.0, 'wer_args': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0001]}, 'lr_scheduler': {'_name': 'tri_stage', 'warmup_steps': 0, 'hold_steps': 0, 'decay_steps': 0, 'phase_ratio': [0.1, 0.4, 0.5], 'init_lr_scale': 0.01, 'final_lr_scale': 0.05, 'max_update': 20000.0, 'lr': [0.0001]}, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'trainer': {'tensorboard_logdir': '/h/addisonw/fairseq/logs/tb/'}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
AA False
BB False
build model called with this config: 
{'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': None, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}
[2024-04-23 21:30:23,249][fairseq.tasks.audio_finetuning][INFO] - Using dict_path : /h/addisonw/fairseq/manifests/finetuning_data10h/dict.ltr.txt
ENTERED MAIN
Python path: ['/fs01/home/addisonw/fairseq/fairseq_cli', '/h/addisonw/fairseq', '/fs01/home/addisonw/fairseq', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python38.zip', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/lib-dynload', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/site-packages']
AA False
BB False
build model called with this config: 
{'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': None, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}
LOADING CHECKPOINT HERE!!!
path:  /h/addisonw/fairseq/pretrained_models/base_libri.pt
cfg: 
{'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': None, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}
w2v_args:
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': {'_name': 'model', 'loss_weights': {}, 'log_keys': ['ema_decay', 'target_var', 'pred_var', 'model_norm', 'ema_norm', 'masked_pct'], 'rescale': 1.0, 'can_sum': True, 'log_ppl': False}, 'optimizer': {'_name': 'adam', 'adam_betas': [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': {'_name': 'cosine', 'warmup_updates': 8000, 'warmup_init_lr': -1.0, 'lr': [0.00075], 'min_lr': 0.0, 't_mult': 1.0, 'lr_period_updates': -1.0, 'lr_shrink': 0.1, 'max_update': 400000}, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'forENTERED MAIN
Python path: ['/fs01/home/addisonw/fairseq/fairseq_cli', '/h/addisonw/fairseq', '/fs01/home/addisonw/fairseq', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python38.zip', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/lib-dynload', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/site-packages']
AA False
BB False
build model called with this config: 
{'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': None, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}
LOADING CHECKPOINT HERE!!!
path:  /h/addisonw/fairseq/pretrained_models/base_libri.pt
cfg: 
{'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': None, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}
w2v_args:
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': {'_name': 'model', 'loss_weights': {}, 'log_keys': ['ema_decay', 'target_var', 'pred_var', 'model_norm', 'ema_norm', 'masked_pct'], 'rescale': 1.0, 'can_sum': True, 'log_ppl': False}, 'optimizer': {'_name': 'adam', 'adam_betas': [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': {'_name': 'cosine', 'warmup_updates': 8000, 'warmup_init_lr': -1.0, 'lr': [0.00075], 'min_lr': 0.0, 't_mult': 1.0, 'lr_period_updates': -1.0, 'lr_shrink': 0.1, 'max_update': 400000}, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
w2v_args NOW: 
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': None, 'optimizer': {'_name': 'adam', 'adam_betas'matter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
w2v_args NOW: 
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': None, 'optimizer': {'_name': 'adam', 'adam_betas'LOADING CHECKPOINT HERE!!!
path:  /h/addisonw/fairseq/pretrained_models/base_libri.pt
cfg: 
{'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': None, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}
w2v_args:
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': {'_name': 'model', 'loss_weights': {}, 'log_keys': ['ema_decay', 'target_var', 'pred_var', 'model_norm', 'ema_norm', 'masked_pct'], 'rescale': 1.0, 'can_sum': True, 'log_ppl': False}, 'optimizer': {'_name': 'adam', 'adam_betas': [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': {'_name': 'cosine', 'warmup_updates': 8000, 'warmup_init_lr': -1.0, 'lr': [0.00075], 'min_lr': 0.0, 't_mult': 1.0, 'lr_period_updates': -1.0, 'lr_shrink': 0.1, 'max_update': 400000}, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'forENTERED MAIN
Python path: ['/fs01/home/addisonw/fairseq/fairseq_cli', '/h/addisonw/fairseq', '/fs01/home/addisonw/fairseq', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python38.zip', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/lib-dynload', '/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/site-packages']
AA False
BB False
build model called with this config: 
{'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': None, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}
LOADING CHECKPOINT HERE!!!
path:  /h/addisonw/fairseq/pretrained_models/base_libri.pt
cfg: 
{'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': None, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}
w2v_args:
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': {'_name': 'model', 'loss_weights': {}, 'log_keys': ['ema_decay', 'target_var', 'pred_var', 'model_norm', 'ema_norm', 'masked_pct'], 'rescale': 1.0, 'can_sum': True, 'log_ppl': False}, 'optimizer': {'_name': 'adam', 'adam_betas': [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': {'_name': 'cosine', 'warmup_updates': 8000, 'warmup_init_lr': -1.0, 'lr': [0.00075], 'min_lr': 0.0, 't_mult': 1.0, 'lr_period_updates': -1.0, 'lr_shrink': 0.1, 'max_update': 400000}, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
[2024-04-23 21:30:25,788][fairseq.models.wav2vec.wav2vec2_asr][INFO] - {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': None, 'optimizer': {'_name': 'adam', 'adam_betas': [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': None, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
matter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
w2v_args NOW: 
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, w2v_args NOW: 
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': N'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': None, 'optimizer': {'_name': 'adam', 'adam_betas'one, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': None, 'optimizer': {'_name': 'adam', 'adam_betas': [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': None, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
self.is_d2v_multi:  True
build model called with this config: 
{'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}
ADD GAUSSIAN NOISE TO TRAINING?:  False
ADD UNIFORM NOISE TO TRAINING?:  True
[2024-04-23 21:30:29,103][data2vec.models.data2vec2][INFO] - making target model
: [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': None, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
self.is_d2v_multi:  True
build model called with this config: 
{'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}
ADD GAUSSIAN NOISE TO TRAINING?:  False
ADD UNIFORM NOISE TO TRAINING?:  True
ADD GAUSSIAN NOISE TO TRAINING?:  False
ADD UNIFORM NOISE TO TRAINING?:  True
: [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': None, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
self.is_d2v_multi:  True
build model called with this config: 
{'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}
ADD GAUSSIAN NOISE TO TRAINING?:  False
ADD UNIFORM NOISE TO TRAINING?:  True
ADD GAUSSIAN NOISE TO TRAINING?:  False
ADD UNIFORM NOISE TO TRAINING?:  True
: [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': None, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
self.is_d2v_multi:  True
build model called with this config: 
{'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}
ADD GAUSSIAN NOISE TO TRAINING?:  False
ADD UNIFORM NOISE TO TRAINING?:  True
ADD GAUSSIAN NOISE TO TRAINING?:  False
ADD UNIFORM NOISE TO TRAINING?:  True
Data2VecMultiModel(
  (modality_encoders): ModuleDict(
    (AUDIO): AudioEncoder(
      (local_encoder): ConvFeatureExtractionModel(
        (conv_layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
          (1-4): 4 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
          (5-6): 2 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
        )
      )
      (project_features): Sequential(
        (0): TransposeLast()
        (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (2): Linear(in_features=512, out_features=768, bias=True)
      )
      (relative_positional_encoder): Sequential(
        (0): TransposeLast()
        (1): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (2): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (3): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (4): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (5): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (6): TransposeLast()
      )
      (context_encoder): BlockEncoder(
        (blocks): ModuleList(
          (0-3): 4 x AltBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): AltAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (attn_drop): Dropout(p=0.0, inplace=False)
              (proj): Linear(in_features=768, out_features=768, bias=True)
              (proj_drop): Dropout(p=0.0, inplace=False)
            )
            (drop_path): Identity()
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.1, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.1, inplace=False)
            )
            (post_mlp_dropout): Dropout(p=0.0, inplace=False)
          )
        )
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.0, inplace=True)
      )
      (decoder): None
    )
  )
  (dropout_input): Dropout(p=0.0, inplace=False)
  (blocks): ModuleList(
    (0-7): 8 x AltBlock(
      (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): AltAttention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.1, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.1, inplace=False)
      )
      (post_mlp_dropout): Dropout(p=0.0, inplace=False)
    )
  )
)
load state dict config
None
again load state dict config
None
TASK NAME!!
AudioFinetuningTask
config passed in!
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 50, 'log_format': 'json', 'log_file': '/h/addisonw/fairseq/logs/gaussianNoise/log.json', 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': 'examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 4, 'distributed_num_procs': 4, 'distributed_rank': 2, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:49623', 'distributed_port': 49623, 'device_id': 2, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1280000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 1280000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 20000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': True, 'update_freq': [5], 'lr': [0.0001], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': '/h/addisonw/fairseq/checkpoints/gaussianNoise', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 5, 'save_interval_updates': 10000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'wer', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': None, 'optimizer': {'_name': 'adam', 'adam_betas': [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': None, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}, 'task': {'_name': 'audio_finetuning', 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'labels': 'ltr', 'multi_corpus_keys': None, 'multi_corpus_sampling_weights': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': None, 'min_sample_size': None, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': none, 'rebuild_batches': True, 'precompute_mask_config': None, 'post_save_script': None, 'subsample': 1.0, 'seed': 1, 'eval_wer': True, 'add_gaussian_train_noise': False, 'add_uniform_train_noise': False, 'eval_wer_config': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_wer_tokenizer': None, 'eval_wer_post_process': 'letter', 'eval_bleu': False, 'eval_bleu_detok': None, 'eval_bleu_detok_args': '{}', 'eval_tokenized_bleu': False, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': '{}', 'eval_bleu_print_samples': False, 'autoregressive': False, 'target_dictionary': None}, 'criterion': {'_name': 'ctc', 'zero_infinity': True, 'sentence_avg': True, 'post_process': 'letter', 'wer_kenlm_model': '/h/addisonw/fairseq/pretrained_models/kenlm/4-gram.bin', 'wer_lexicon': '/h/addisonw/fairseq/pretrained_models/kenlm/lexicon.txt', 'wer_lm_weight': 2.0, 'wer_word_score': -1.0, 'wer_sil_weight': 0.0, 'wer_args': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0001]}, 'lr_scheduler': {'_name': 'tri_stage', 'warmup_steps': 0, 'hold_steps': 0, 'decay_steps': 0, 'phase_ratio': [0.1, 0.4, 0.5], 'init_lr_scale': 0.01, 'final_lr_scale': 0.05, 'max_update': 20000.0, 'lr': [0.0001]}, 'Data2VecMultiModel(
  (modality_encoders): ModuleDict(
    (AUDIO): AudioEncoder(
      (local_encoder): ConvFeatureExtractionModel(
        (conv_layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
          (1-4): 4 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
          (5-6): 2 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
        )
      )
      (project_features): Sequential(
        (0): TransposeLast()
        (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (2): Linear(in_features=512, out_features=768, bias=True)
      )
      (relative_positional_encoder): Sequential(
        (0): TransposeLast()
        (1): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (2): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (3): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (4): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (5): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (6): TransposeLast()
      )
      (context_encoder): BlockEncoder(
        (blocks): ModuleList(
          (0-3): 4 x AltBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): AltAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (attn_drop): Dropout(p=0.0, inplace=False)
              (proj): Linear(in_features=768, out_features=768, bias=True)
              (proj_drop): Dropout(p=0.0, inplace=False)
            )
            (drop_path): Identity()
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.1, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.1, inplace=False)
            )
            (post_mlp_dropout): Dropout(p=0.0, inplace=False)
          )
        )
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.0, inplace=True)
      )
      (decoder): None
    )
  )
  (dropout_input): Dropout(p=0.0, inplace=False)
  (blocks): ModuleList(
    (0-7): 8 x AltBlock(
      (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): AltAttention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.1, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.1, inplace=False)
      )
      (post_mlp_dropout): Dropout(p=0.0, inplace=False)
    )
  )
)
load state dict config
None
again load state dict config
None
TASK NAME!!
AudioFinetuningTask
config passed in!
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 50, 'log_format': 'json', 'log_file': '/h/addisonw/fairseq/logs/gaussianNoise/log.json', 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': 'examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 4, 'distributed_num_procs': 4, 'distributed_rank': 1, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:49623', 'distributed_port': 49623, 'device_id': 1, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1280000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 1280000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 20000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': True, 'update_freq': [5], 'lr': [0.0001], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': '/h/addisonw/fairseq/checkpoints/gaussianNoise', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 5, 'save_interval_updates': 10000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'wer', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': None, 'optimizer': {'_name': 'adam', 'adam_betas': [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': None, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}, 'task': {'_name': 'audio_finetuning', 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'labels': 'ltr', 'multi_corpus_keys': None, 'multi_corpus_sampling_weights': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': None, 'min_sample_size': None, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': none, 'rebuild_batches': True, 'precompute_mask_config': None, 'post_save_script': None, 'subsample': 1.0, 'seed': 1, 'eval_wer': True, 'add_gaussian_train_noise': False, 'add_uniform_train_noise': False, 'eval_wer_config': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_wer_tokenizer': None, 'eval_wer_post_process': 'letter', 'eval_bleu': False, 'eval_bleu_detok': None, 'eval_bleu_detok_args': '{}', 'eval_tokenized_bleu': False, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': '{}', 'eval_bleu_print_samples': False, 'autoregressive': False, 'target_dictionary': None}, 'criterion': {'_name': 'ctc', 'zero_infinity': True, 'sentence_avg': True, 'post_process': 'letter', 'wer_kenlm_model': '/h/addisonw/fairseq/pretrained_models/kenlm/4-gram.bin', 'wer_lexicon': '/h/addisonw/fairseq/pretrained_models/kenlm/lexicon.txt', 'wer_lm_weight': 2.0, 'wer_word_score': -1.0, 'wer_sil_weight': 0.0, 'wer_args': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0001]}, 'lr_scheduler': {'_name': 'tri_stage', 'warmup_steps': 0, 'hold_steps': 0, 'decay_steps': 0, 'phase_ratio': [0.1, 0.4, 0.5], 'init_lr_scale': 0.01, 'final_lr_scale': 0.05, 'max_update': 20000.0, 'lr': [0.0001]}, 'ADD GAUSSIAN NOISE TO TRAINING?:  False
ADD UNIFORM NOISE TO TRAINING?:  True
Data2VecMultiModel(
  (modality_encoders): ModuleDict(
    (AUDIO): AudioEncoder(
      (local_encoder): ConvFeatureExtractionModel(
        (conv_layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
          (1-4): 4 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
          (5-6): 2 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
        )
      )
      (project_features): Sequential(
        (0): TransposeLast()
        (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (2): Linear(in_features=512, out_features=768, bias=True)
      )
      (relative_positional_encoder): Sequential(
        (0): TransposeLast()
        (1): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (2): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (3): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (4): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (5): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (6): TransposeLast()
      )
      (context_encoder): BlockEncoder(
        (blocks): ModuleList(
          (0-3): 4 x AltBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): AltAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (attn_drop): Dropout(p=0.0, inplace=False)
              (proj): Linear(in_features=768, out_features=768, bias=True)
              (proj_drop): Dropout(p=0.0, inplace=False)
            )
            (drop_path): Identity()
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.1, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.1, inplace=False)
            )
            (post_mlp_dropout): Dropout(p=0.0, inplace=False)
          )
        )
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.0, inplace=True)
      )
      (decoder): None
    )
  )
  (dropout_input): Dropout(p=0.0, inplace=False)
  (blocks): ModuleList(
    (0-7): 8 x AltBlock(
      (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): AltAttention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.1, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.1, inplace=False)
      )
      (post_mlp_dropout): Dropout(p=0.0, inplace=False)
    )
  )
)
load state dict config
None
again load state dict config
None
[2024-04-23 21:30:59,947][fairseq_cli.train][INFO] - Wav2VecCtc(
  (w2v_encoder): Wav2VecEncoder(
    (w2v_model): Data2VecMultiModel(
      (modality_encoders): ModuleDict(
        (AUDIO): AudioEncoder(
          (local_encoder): ConvFeatureExtractionModel(
            (conv_layers): ModuleList(
              (0): Sequential(
                (0): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
                (1): Dropout(p=0.0, inplace=False)
                (2): Sequential(
                  (0): TransposeLast()
                  (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                  (2): TransposeLast()
                )
                (3): GELU(approximate='none')
              )
              (1-4): 4 x Sequential(
                (0): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
                (1): Dropout(p=0.0, inplace=False)
                (2): Sequential(
                  (0): TransposeLast()
                  (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                  (2): TransposeLast()
                )
                (3): GELU(approximate='none')
              )
              (5-6): 2 x Sequential(
                (0): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
                (1): Dropout(p=0.0, inplace=False)
                (2): Sequential(
                  (0): TransposeLast()
                  (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
                  (2): TransposeLast()
                )
                (3): GELU(approximate='none')
              )
            )
          )
          (project_features): Sequential(
            (0): TransposeLast()
            (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
            (2): Linear(in_features=512, out_features=768, bias=True)
          )
          (relative_positional_encoder): Sequential(
            (0): TransposeLast()
            (1): Sequential(
              (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
              (1): SamePad()
              (2): TransposeLast()
              (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
              (4): TransposeLast()
              (5): GELU(approximate='none')
            )
            (2): Sequential(
              (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
              (1): SamePad()
              (2): TransposeLast()
              (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
              (4): TransposeLast()
              (5): GELU(approximate='none')
            )
            (3): Sequential(
              (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
              (1): SamePad()
              (2): TransposeLast()
              (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
              (4): TransposeLast()
              (5): GELU(approximate='none')
            )
            (4): Sequential(
              (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
              (1): SamePad()
              (2): TransposeLast()
              (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
              (4): TransposeLast()
              (5): GELU(approximate='none')
            )
            (5): Sequential(
              (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
              (1): SamePad()
              (2): TransposeLast()
              (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
              (4): TransposeLast()
              (5): GELU(approximate='none')
            )
            (6): TransposeLast()
          )
          (context_encoder): BlockEncoder(
            (blocks): ModuleList(
              (0-3): 4 x AltBlock(
                (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (attn): AltAttention(
                  (qkv): Linear(in_features=768, out_features=2304, bias=True)
                  (attn_drop): Dropout(p=0.0, inplace=False)
                  (proj): Linear(in_features=768, out_features=768, bias=True)
                  (proj_drop): Dropout(p=0.0, inplace=False)
                )
                (drop_path): Identity()
                (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (mlp): Mlp(
                  (fc1): Linear(in_features=768, out_features=3072, bias=True)
                  (act): GELU(approximate='none')
                  (drop1): Dropout(p=0.1, inplace=False)
                  (norm): Identity()
                  (fc2): Linear(in_features=3072, out_features=768, bias=True)
                  (drop2): Dropout(p=0.1, inplace=False)
                )
                (post_mlp_dropout): Dropout(p=0.0, inplace=False)
              )
            )
            (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (dropout): Dropout(p=0.0, inplace=True)
          )
          (decoder): None
        )
      )
      (dropout_input): Dropout(p=0.0, inplace=False)
      (blocks): ModuleList(
        (0-7): 8 x AltBlock(
          (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (attn): AltAttention(
            (qkv): Linear(in_features=768, out_features=2304, bias=True)
            (attn_drop): Dropout(p=0.0, inplace=False)
            (proj): Linear(in_features=768, out_features=768, bias=True)
            (proj_drop): Dropout(p=0.0, inplace=False)
          )
          (drop_path): Identity()
          (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (mlp): Mlp(
            (fc1): Linear(in_features=768, out_features=3072, bias=True)
            (act): GELU(approximate='none')
            (drop1): Dropout(p=0.1, inplace=False)
            (norm): Identity()
            (fc2): Linear(in_features=3072, out_features=768, bias=True)
            (drop2): Dropout(p=0.1, inplace=False)
          )
          (post_mlp_dropout): Dropout(p=0.0, inplace=False)
        )
      )
    )
    (final_dropout): Dropout(p=0.0, inplace=False)
    (proj): Linear(in_features=768, out_features=32, bias=True)
  )
)
[2024-04-23 21:31:00,050][fairseq_cli.train][INFO] - task: AudioFinetuningTask
[2024-04-23 21:31:00,050][fairseq_cli.train][INFO] - model: Wav2VecCtc
[2024-04-23 21:31:00,050][fairseq_cli.train][INFO] - criterion: CtcCriterion
[2024-04-23 21:31:00,054][fairseq_cli.train][INFO] - num. shared model params: 93,188,140 (num. trained: 93,188,140)
[2024-04-23 21:31:00,057][fairseq_cli.train][INFO] - num. expert model params: 0 (num. trained: 0)
[2024-04-23 21:31:00,062][fairseq.data.audio.raw_audio_dataset][INFO] - loaded 32, skipped 0 samples
TASK NAME!!
AudioFinetuningTask
config passed in!
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 50, 'log_format': 'json', 'log_file': '/h/addisonw/fairseq/logs/gaussianNoise/log.json', 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': 'examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 4, 'distributed_num_procs': 4, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:49623', 'distributed_port': 49623, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1280000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 1280000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 20000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': True, 'update_freq': [5], 'lr': [0.0001], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': '/h/addisonw/fairseq/checkpoints/gaussianNoise', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 5, 'save_interval_updates': 10000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'wer', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': None, 'optimizer': {'_name': 'adam', 'adam_betas': [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': None, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}, 'task': {'_name': 'audio_finetuning', 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'labels': 'ltr', 'multi_corpus_keys': None, 'multi_corpus_sampling_weights': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': None, 'min_sample_size': None, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': none, 'rebuild_batches': True, 'precompute_mask_config': None, 'post_save_script': None, 'subsample': 1.0, 'seed': 1, 'eval_wer': True, 'add_gaussian_train_noise': False, 'add_uniform_train_noise': False, 'eval_wer_config': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_wer_tokenizer': None, 'eval_wer_post_process': 'letter', 'eval_bleu': False, 'eval_bleu_detok': None, 'eval_bleu_detok_args': '{}', 'eval_tokenized_bleu': False, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': '{}', 'eval_bleu_print_samples': False, 'autoregressive': False, 'target_dictionary': None}, 'criterion': {'_name': 'ctc', 'zero_infinity': True, 'sentence_avg': True, 'post_process': 'letter', 'wer_kenlm_model': '/h/addisonw/fairseq/pretrained_models/kenlm/4-gram.bin', 'wer_lexicon': '/h/addisonw/fairseq/pretrained_models/kenlm/lexicon.txt', 'wer_lm_weight': 2.0, 'wer_word_score': -1.0, 'wer_sil_weight': 0.0, 'wer_args': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0001]}, 'lr_scheduler': {'_name': 'tri_stage', 'warmup_steps': 0, 'hold_steps': 0, 'decay_steps': 0, 'phase_ratio': [0.1, 0.4, 0.5], 'init_lr_scale': 0.01, 'final_lr_scale': 0.05, 'max_update': 20000.0, 'lr': [0.0001]}, 'Data2VecMultiModel(
  (modality_encoders): ModuleDict(
    (AUDIO): AudioEncoder(
      (local_encoder): ConvFeatureExtractionModel(
        (conv_layers): ModuleList(
          (0): Sequential(
            (0): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
          (1-4): 4 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
          (5-6): 2 x Sequential(
            (0): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
            (1): Dropout(p=0.0, inplace=False)
            (2): Sequential(
              (0): TransposeLast()
              (1): Fp32LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (2): TransposeLast()
            )
            (3): GELU(approximate='none')
          )
        )
      )
      (project_features): Sequential(
        (0): TransposeLast()
        (1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
        (2): Linear(in_features=512, out_features=768, bias=True)
      )
      (relative_positional_encoder): Sequential(
        (0): TransposeLast()
        (1): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (2): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (3): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (4): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (5): Sequential(
          (0): Conv1d(768, 768, kernel_size=(19,), stride=(1,), padding=(9,), groups=16)
          (1): SamePad()
          (2): TransposeLast()
          (3): LayerNorm((768,), eps=1e-05, elementwise_affine=False)
          (4): TransposeLast()
          (5): GELU(approximate='none')
        )
        (6): TransposeLast()
      )
      (context_encoder): BlockEncoder(
        (blocks): ModuleList(
          (0-3): 4 x AltBlock(
            (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (attn): AltAttention(
              (qkv): Linear(in_features=768, out_features=2304, bias=True)
              (attn_drop): Dropout(p=0.0, inplace=False)
              (proj): Linear(in_features=768, out_features=768, bias=True)
              (proj_drop): Dropout(p=0.0, inplace=False)
            )
            (drop_path): Identity()
            (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
            (mlp): Mlp(
              (fc1): Linear(in_features=768, out_features=3072, bias=True)
              (act): GELU(approximate='none')
              (drop1): Dropout(p=0.1, inplace=False)
              (norm): Identity()
              (fc2): Linear(in_features=3072, out_features=768, bias=True)
              (drop2): Dropout(p=0.1, inplace=False)
            )
            (post_mlp_dropout): Dropout(p=0.0, inplace=False)
          )
        )
        (norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        (dropout): Dropout(p=0.0, inplace=True)
      )
      (decoder): None
    )
  )
  (dropout_input): Dropout(p=0.0, inplace=False)
  (blocks): ModuleList(
    (0-7): 8 x AltBlock(
      (norm1): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (attn): AltAttention(
        (qkv): Linear(in_features=768, out_features=2304, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=768, out_features=768, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (mlp): Mlp(
        (fc1): Linear(in_features=768, out_features=3072, bias=True)
        (act): GELU(approximate='none')
        (drop1): Dropout(p=0.1, inplace=False)
        (norm): Identity()
        (fc2): Linear(in_features=3072, out_features=768, bias=True)
        (drop2): Dropout(p=0.1, inplace=False)
      )
      (post_mlp_dropout): Dropout(p=0.0, inplace=False)
    )
  )
)
load state dict config
None
again load state dict config
None
TASK NAME!!
AudioFinetuningTask
config passed in!
{'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 50, 'log_format': 'json', 'log_file': '/h/addisonw/fairseq/logs/gaussianNoise/log.json', 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': None, 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': 'examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 4, 'distributed_num_procs': 4, 'distributed_rank': 3, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://localhost:49623', 'distributed_port': 49623, 'device_id': 3, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 4, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 2, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1280000, 'batch_size': None, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': 1280000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 20000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': True, 'update_freq': [5], 'lr': [0.0001], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': False}, 'checkpoint': {'_name': None, 'save_dir': '/h/addisonw/fairseq/checkpoints/gaussianNoise', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 5, 'save_interval_updates': 10000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'wer', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 4}, 'generation': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'wav2vec_ctc', 'w2v_path': '/h/addisonw/fairseq/pretrained_models/base_libri.pt', 'no_pretrained_weights': False, 'dropout_input': 0.0, 'final_dropout': 0.0, 'dropout': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'apply_mask': True, 'mask_length': 10, 'mask_prob': 0.75, 'mask_selection': static, 'mask_other': 0.0, 'no_mask_overlap': False, 'mask_min_space': 1, 'require_same_masks': True, 'mask_dropout': 0.0, 'mask_channel_length': 64, 'mask_channel_prob': 0.25, 'mask_channel_selection': static, 'mask_channel_other': 0.0, 'no_mask_channel_overlap': False, 'freeze_finetune_updates': 10000, 'feature_grad_mult': 0.0, 'layerdrop': 0.1, 'drop_path': 0.0, 'mask_channel_min_space': 1, 'mask_channel_before': False, 'normalize': True, 'update_alibi': True, 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'w2v_args': {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 200, 'log_format': 'json', 'log_file': None, 'aim_repo': None, 'aim_run_hash': None, 'tensorboard_logdir': 'tb', 'wandb_project': None, 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': False, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'on_cpu_convert_precision': False, 'min_loss_scale': 1e-06, 'threshold_loss_scale': None, 'amp': False, 'amp_batch_retries': 2, 'amp_init_scale': 128, 'amp_scale_window': None, 'user_dir': '/data/home/abaevski/fairseq-py/examples/data2vec', 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma'}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None}, 'distributed_training': {'_name': None, 'distributed_world_size': 16, 'distributed_num_procs': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'tcp://a100-st-p4d24xlarge-466:38089', 'distributed_port': 38089, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'legacy_ddp', 'ddp_comm_hook': 'none', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'gradient_as_bucket_view': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_base_algorithm': 'localsgd', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'fp16': True, 'memory_efficient_fp16': False, 'fsdp_mp': False, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False, 'not_fsdp_flatten_parameters': False}, 'dataset': {'_name': None, 'num_workers': 6, 'skip_invalid_size_inputs_valid_test': True, 'max_tokens': 1000000, 'batch_size': None, 'required_batch_size_multiple': 1, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 5, 'validate_interval_updates': 0, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': True, 'max_tokens_valid': 1000000, 'batch_size_valid': None, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0, 'grouped_shuffling': False, 'update_epoch_batch_itr': False, 'update_ordered_indices_seed': False}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 400000, 'stop_time_hours': 0.0, 'clip_norm': 0.0, 'sentence_avg': False, 'update_freq': [1], 'lr': [0.00075], 'stop_min_lr': -1.0, 'use_bmuf': False, 'skip_remainder_batch': False, 'debug_param_names': True}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'continue_once': None, 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 25000, 'keep_interval_updates': 1, 'keep_interval_updates_pattern': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': False, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_save_optimizer_state': False, 'best_checkpoint_metric': 'loss', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 16}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_lm': {'_name': None, 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'data2vec_multi', 'cosine_loss_temp': 0.0, 'loss_beta': 0.0, 'loss_scale': None, 'mean_loss': False, 'reconstruct_all': False, 'depth': 8, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_heads': 12, 'norm_eps': 1e-05, 'norm_affine': True, 'encoder_dropout': 0.0, 'post_mlp_drop': 0.0, 'attention_dropout': 0.0, 'activation_dropout': 0.1, 'dropout_input': 0.0, 'layerdrop': 0.1, 'embed_dim': 768, 'mlp_ratio': 4.0, 'layer_norm_first': False, 'average_top_k_layers': 8, 'end_of_block_targets': False, 'clone_batch': 8, 'layer_norm_target_layer': False, 'batch_norm_target_layer': False, 'instance_norm_target_layer': True, 'instance_norm_targets': False, 'layer_norm_targets': False, 'ema_decay': 0.999, 'ema_same_dtype': True, 'log_norms': True, 'ema_end_decay': 0.99999, 'ema_anneal_end_step': 75000, 'ema_encoder_only': False, 'max_update': 400000, 'modalities': {'audio': {'type': 'AUDIO', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.05, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': True, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': True, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': {'decoder_dim': 384, 'decoder_groups': 16, 'decoder_kernel': 7, 'decoder_layers': 4, 'input_dropout': 0.1, 'add_positions_masked': False, 'add_positions_all': False, 'final_layer_norm': False, 'tanh_scale': 0.0, 'project_first_residual': False, 'decoder_residual': True, 'projection_layers': 1, 'projection_ratio': 2.0, 'residual_scale': 1.0, 'remove_residual_noise': False, 'post_residual_ln': False}, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'extractor_mode': 'layer_norm', 'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'conv_pos_width': 95, 'conv_pos_groups': 16, 'conv_pos_depth': 5, 'conv_pos_pre_ln': False, 'mlp_encoder': False, 'mlp_n_in': 320, 'mlp_dim': None, 'mlp_layers': 9}, 'image': {'type': 'IMAGE', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'input_size': 224, 'in_chans': 3, 'patch_size': 16, 'embed_dim': 768, 'fix_masks': False, 'exact_mask_pct': False, 'unmask_focal': False, 'focal_length': 1, 'alibi_dims': 2, 'alibi_distance': 'manhattan', 'fixed_positions': True, 'conv_pos_cfg': None, 'transformer_decoder': False, 'enc_dec_transformer': False, 'conv_mae': False, 'conv_mae_multiscale': True, 'conv_mae_masking': True}, 'text': {'type': 'TEXT', 'prenet_depth': 4, 'prenet_layerdrop': 0.1, 'prenet_dropout': 0.0, 'start_drop_path_rate': 0.0, 'end_drop_path_rate': 0.0, 'num_extra_tokens': 0, 'init_extra_token_zero': True, 'mask_noise_std': 0.01, 'mask_prob_min': None, 'mask_prob': 0.75, 'inverse_mask': False, 'mask_prob_adjust': 0.0, 'keep_masked_pct': 0.0, 'mask_length': 10, 'add_masks': False, 'remove_masks': False, 'mask_dropout': 0.0, 'encoder_zero_mask': False, 'mask_channel_prob': 0.25, 'mask_channel_length': 64, 'ema_local_encoder': False, 'local_grad_mult': 0.0, 'use_alibi_encoder': False, 'alibi_scale': 1.0, 'learned_alibi': False, 'alibi_max_pos': None, 'learned_alibi_scale': True, 'learned_alibi_scale_per_head': False, 'learned_alibi_scale_per_layer': False, 'num_alibi_heads': 12, 'model_depth': 8, 'decoder': None, 'max_alibi_scale': 0.0, 'max_alibi_grad': 0.0, 'max_alibi_val': 0.0, 'max_source_positions': 512, 'learned_pos': True, 'dropout': 0.0, 'no_scale_embedding': True, 'layernorm_embedding': True, 'no_token_positional_embeddings': False}}, 'shared_decoder': None, 'min_target_var': 0.1, 'min_pred_var': 0.01, 'supported_modality': 'AUDIO', 'mae_init': False, 'bert_init': True, 'seed': 1, 'skip_ema': False, 'cls_loss': 0.0, 'alt_cls_targets': False, 'recon_loss': 0.0, 'recon_dim': 0, 'd2v_loss': 1.0, 'qk_scale': None, 'cosine_attention': False, 'decoder_group': False}, 'task': {'_name': 'audio_pretraining', 'data': '/fsx-wav2vec/abaevski/data/librispeech', 'labels': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': 320000, 'min_sample_size': 32000, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': 'none', 'rebuild_batches': True, 'precompute_mask_config': {'feature_encoder_spec': '[(512, 10, 5)] + [(512, 3, 2)] * 4 + [(512,2,2)] + [(512,2,2)]', 'mask_prob': 0.75, 'mask_prob_adjust': 0.05, 'mask_length': 10, 'inverse_mask': False, 'clone_batch': 8}, 'post_save_script': None}, 'criterion': None, 'optimizer': {'_name': 'adam', 'adam_betas': [0.9, 0.98], 'adam_eps': 1e-06, 'weight_decay': 0.01, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.00075], 'min_decay_val': 0.0}, 'lr_scheduler': None, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}, 'offload_activations': False, 'min_params_to_wrap': 100000000, 'checkpoint_activations': False, 'ddp_backend': 'legacy_ddp', 'zero_mask': False, 'load_ema': False, 'layer_decay': 1.0, 'layer_type': transformer, 'adp_num': -1, 'adp_dim': 64, 'adp_act_fn': 'relu', 'adp_trf_idx': 'all', 'freeze_regex': None, 'blank_weight': 0.0, 'blank_mode': 'add'}, 'task': {'_name': 'audio_finetuning', 'data': '/h/addisonw/fairseq/manifests/finetuning_data10h', 'labels': 'ltr', 'multi_corpus_keys': None, 'multi_corpus_sampling_weights': None, 'binarized_dataset': False, 'sample_rate': 16000, 'normalize': True, 'enable_padding': False, 'max_sample_size': None, 'min_sample_size': None, 'num_batch_buckets': 0, 'tpu': False, 'text_compression_level': none, 'rebuild_batches': True, 'precompute_mask_config': None, 'post_save_script': None, 'subsample': 1.0, 'seed': 1, 'eval_wer': True, 'add_gaussian_train_noise': False, 'add_uniform_train_noise': False, 'eval_wer_config': {'_name': None, 'beam': 5, 'beam_mt': 0, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'max_len_a_mt': 0.0, 'max_len_b_mt': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'lenpen_mt': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False, 'eos_token': None}, 'eval_wer_tokenizer': None, 'eval_wer_post_process': 'letter', 'eval_bleu': False, 'eval_bleu_detok': None, 'eval_bleu_detok_args': '{}', 'eval_tokenized_bleu': False, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': '{}', 'eval_bleu_print_samples': False, 'autoregressive': False, 'target_dictionary': None}, 'criterion': {'_name': 'ctc', 'zero_infinity': True, 'sentence_avg': True, 'post_process': 'letter', 'wer_kenlm_model': '/h/addisonw/fairseq/pretrained_models/kenlm/4-gram.bin', 'wer_lexicon': '/h/addisonw/fairseq/pretrained_models/kenlm/lexicon.txt', 'wer_lm_weight': 2.0, 'wer_word_score': -1.0, 'wer_sil_weight': 0.0, 'wer_args': None}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9,0.98)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'lr': [0.0001]}, 'lr_scheduler': {'_name': 'tri_stage', 'warmup_steps': 0, 'hold_steps': 0, 'decay_steps': 0, 'phase_ratio': [0.1, 0.4, 0.5], 'init_lr_scale': 0.01, 'final_lr_scale': 0.05, 'max_update': 20000.0, 'lr': [0.0001]}, 'scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'trainer': {'tensorboard_logdir': '/h/addisonw/fairseq/logs/tb/'}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
[2024-04-23 21:31:02,778][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.1.0.bias
[2024-04-23 21:31:02,800][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.2.0.bias
[2024-04-23 21:31:02,800][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.3.0.bias
[2024-04-23 21:31:02,801][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.4.0.bias
[2024-04-23 21:31:02,801][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.5.0.bias
[2024-04-23 21:31:02,801][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.6.0.bias
[2024-04-23 21:31:02,801][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.relative_positional_encoder.1.3.weight
[2024-04-23 21:31:02,801][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.relative_positional_encoder.1.3.bias
[2024-04-23 21:31:02,802][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.relative_positional_encoder.2.3.weight
[2024-04-23 21:31:02,808][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.relative_positional_encoder.2.3.bias
[2024-04-23 21:31:02,808][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.relative_positional_encoder.3.3.weight
[2024-04-23 21:31:02,808][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.relative_positional_encoder.3.3.bias
[2024-04-23 21:31:02,808][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.relative_positional_encoder.4.3.weight
[2024-04-23 21:31:02,809][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.relative_positional_encoder.4.3.bias
[2024-04-23 21:31:02,809][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.relative_positional_encoder.5.3.weight
[2024-04-23 21:31:02,815][fairseq.trainer][INFO] - detected shared parameter: w2v_encoder.w2v_model.modality_encoders.AUDIO.local_encoder.conv_layers.0.0.bias <- w2v_encoder.w2v_model.modality_encoders.AUDIO.relative_positional_encoder.5.3.bias
[2024-04-23 21:31:03,333][fairseq.utils][INFO] - ***********************CUDA enviroments for all 4 workers***********************
[2024-04-23 21:31:03,334][fairseq.utils][INFO] - rank   0: capabilities =  7.5  ; total memory = 14.748 GB ; name = Tesla T4                                
[2024-04-23 21:31:03,334][fairseq.utils][INFO] - rank   1: capabilities =  7.5  ; total memory = 14.748 GB ; name = Tesla T4                                
[2024-04-23 21:31:03,334][fairseq.utils][INFO] - rank   2: capabilities =  7.5  ; total memory = 14.748 GB ; name = Tesla T4                                
[2024-04-23 21:31:03,335][fairseq.utils][INFO] - rank   3: capabilities =  7.5  ; total memory = 14.748 GB ; name = Tesla T4                                
[2024-04-23 21:31:03,335][fairseq.utils][INFO] - ***********************CUDA enviroments for all 4 workers***********************
[2024-04-23 21:31:03,336][fairseq_cli.train][INFO] - training on 4 devices (GPUs/TPUs)
[2024-04-23 21:31:03,336][fairseq_cli.train][INFO] - max tokens per device = 1280000 and max sentences per device = None
[2024-04-23 21:31:03,339][fairseq.trainer][INFO] - Preparing to load checkpoint /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_last.pt
[2024-04-23 21:31:03,339][fairseq.trainer][INFO] - No existing checkpoint found /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_last.pt
[2024-04-23 21:31:03,339][fairseq.trainer][INFO] - loading train data for epoch 1
[2024-04-23 21:31:03,350][fairseq.data.audio.raw_audio_dataset][INFO] - loaded 2731, skipped 0 samples
[2024-04-23 21:31:03,505][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:31:03,506][fairseq.tasks.fairseq_task][INFO] - reuse_dataloader = True
[2024-04-23 21:31:03,507][fairseq.tasks.fairseq_task][INFO] - rebuild_batches = True
[2024-04-23 21:31:03,507][fairseq.tasks.fairseq_task][INFO] - batches will be rebuilt for each epoch
[2024-04-23 21:31:03,507][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 1
[2024-04-23 21:31:04,308][fairseq_cli.train][INFO] - begin dry-run validation on "valid" subset
[2024-04-23 21:31:04,309][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:31:04,310][fairseq.tasks.fairseq_task][INFO] - reuse_dataloader = True
[2024-04-23 21:31:04,310][fairseq.tasks.fairseq_task][INFO] - rebuild_batches = True
[2024-04-23 21:31:04,310][fairseq.tasks.fairseq_task][INFO] - batches will be rebuilt for each epoch
[2024-04-23 21:31:04,310][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 1
scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'trainer': {'tensorboard_logdir': '/h/addisonw/fairseq/logs/tb/'}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/h/addisonw/fairseq/fairseq/trainer.py:150: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/conda/conda-bld/pytorch_1708025845899/work/torch/csrc/tensor/python_tensor.cpp:83.)
  self._grad_norm_buf = torch.cuda.DoubleTensor(self.data_parallel_world_size)
/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/h/addisonw/fairseq/fairseq/trainer.py:150: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/conda/conda-bld/pytorch_1708025845899/work/torch/csrc/tensor/python_tensor.cpp:83.)
  self._grad_norm_buf = torch.cuda.DoubleTensor(self.data_parallel_world_size)
scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'trainer': {'tensorboard_logdir': '/h/addisonw/fairseq/logs/tb/'}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/h/addisonw/fairseq/fairseq/trainer.py:150: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/conda/conda-bld/pytorch_1708025845899/work/torch/csrc/tensor/python_tensor.cpp:83.)
  self._grad_norm_buf = torch.cuda.DoubleTensor(self.data_parallel_world_size)
scoring': None, 'bpe': None, 'tokenizer': None, 'ema': {'_name': None, 'store_ema': False, 'ema_decay': 0.9999, 'ema_start_update': 0, 'ema_seed_model': None, 'ema_update_freq': 1, 'ema_fp32': False}, 'trainer': {'tensorboard_logdir': '/h/addisonw/fairseq/logs/tb/'}, 'job_logging_cfg': {'version': 1, 'formatters': {'simple': {'format': '[%(asctime)s][%(name)s][%(levelname)s] - %(message)s'}}, 'handlers': {'console': {'class': 'logging.StreamHandler', 'formatter': 'simple', 'stream': 'ext://sys.stdout'}, 'file': {'class': 'logging.FileHandler', 'formatter': 'simple', 'filename': 'hydra_train.log'}}, 'root': {'level': 'INFO', 'handlers': ['console', 'file']}, 'disable_existing_loggers': False}}
/h/addisonw/anaconda3/envs/noisyD2V/lib/python3.8/site-packages/torch/nn/modules/module.py:1877: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/h/addisonw/fairseq/fairseq/trainer.py:150: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at /opt/conda/conda-bld/pytorch_1708025845899/work/torch/csrc/tensor/python_tensor.cpp:83.)
  self._grad_norm_buf = torch.cuda.DoubleTensor(self.data_parallel_world_size)
[2024-04-23 21:31:06,543][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:31:06,555][fairseq.trainer][INFO] - begin training epoch 1
[2024-04-23 21:31:06,556][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:31:18,564][fairseq.trainer][INFO] - NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
[2024-04-23 21:31:21,459][fairseq.trainer][INFO] - NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
[2024-04-23 21:31:23,868][fairseq.trainer][INFO] - NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
[2024-04-23 21:31:26,039][fairseq.trainer][INFO] - NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
[2024-04-23 21:31:28,254][fairseq.trainer][INFO] - NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4.0
[2024-04-23 21:32:03,830][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:32:03,834][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:32:04,272][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 2
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:32:06,617][valid][INFO] - {"epoch": 1, "valid_loss": "2530.87", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "12.26", "valid_uer": "118.618", "valid_wer": "101.981", "valid_raw_wer": "100", "valid_wps": "1588.6", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "20"}
[2024-04-23 21:32:06,619][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.981]
[2024-04-23 21:32:06,619][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:32:06,621][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:32:07,076][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 3
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:32:09,291][valid][INFO] - {"epoch": 1, "valid_loss": "2425.96", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.752", "valid_uer": "104.667", "valid_wer": "100.603", "valid_raw_wer": "100", "valid_wps": "1547.4", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "20"}
[2024-04-23 21:32:09,292][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.603]
[2024-04-23 21:32:09,292][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:32:09,295][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:32:09,764][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 4
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:32:11,982][valid][INFO] - {"epoch": 1, "valid_loss": "2486.67", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "12.046", "valid_uer": "112.756", "valid_wer": "101.378", "valid_raw_wer": "100", "valid_wps": "1617.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "20"}
[2024-04-23 21:32:11,983][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [101.378]
[2024-04-23 21:32:11,983][fairseq_cli.train][INFO] - end of epoch 1 (average epoch stats below)
[2024-04-23 21:32:11,984][train][INFO] - {"epoch": 1, "train_loss": "2357.63", "train_ntokens": "20155", "train_nsentences": "107.7", "train_nll_loss": "12.598", "train_wps": "9134.2", "train_ups": "0.45", "train_wpb": "20155.1", "train_bsz": "107.7", "train_num_updates": "20", "train_lr": "1.99e-06", "train_gnorm": "1200.23", "train_loss_scale": "4", "train_train_wall": "55", "train_gb_free": "11.1", "train_wall": "69"}
[2024-04-23 21:32:11,988][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:32:12,382][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 2
[2024-04-23 21:32:12,590][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:32:12,636][fairseq.trainer][INFO] - begin training epoch 2
[2024-04-23 21:32:12,637][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:32:56,498][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:32:56,500][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:32:57,113][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 5
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:32:59,244][valid][INFO] - {"epoch": 2, "valid_loss": "2526.64", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "12.239", "valid_uer": "118.166", "valid_wer": "102.326", "valid_raw_wer": "100", "valid_wps": "1721.7", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "45"}
[2024-04-23 21:32:59,245][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [102.326]
[2024-04-23 21:32:59,245][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:32:59,247][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:32:59,817][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 6
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:33:02,291][valid][INFO] - {"epoch": 2, "valid_loss": "2417.11", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.709", "valid_uer": "104.408", "valid_wer": "100.947", "valid_raw_wer": "100", "valid_wps": "1671.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "45"}
[2024-04-23 21:33:02,292][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.947]
[2024-04-23 21:33:02,293][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:33:02,295][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:33:02,752][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 7
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:33:04,979][valid][INFO] - {"epoch": 2, "valid_loss": "2482.44", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "12.025", "valid_uer": "112.45", "valid_wer": "101.378", "valid_raw_wer": "100", "valid_wps": "1647", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "45"}
[2024-04-23 21:33:04,980][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [101.378]
[2024-04-23 21:33:04,981][fairseq_cli.train][INFO] - end of epoch 2 (average epoch stats below)
[2024-04-23 21:33:04,981][train][INFO] - {"epoch": 2, "train_loss": "2345.59", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "12.583", "train_wps": "9588.1", "train_ups": "0.47", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "45", "train_lr": "3.2275e-06", "train_gnorm": "1244.45", "train_loss_scale": "4", "train_train_wall": "42", "train_gb_free": "10.6", "train_wall": "122"}
[2024-04-23 21:33:04,986][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:33:05,609][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 3
[2024-04-23 21:33:05,792][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:33:05,811][fairseq.trainer][INFO] - begin training epoch 3
[2024-04-23 21:33:05,822][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:33:15,607][train_inner][INFO] - {"epoch": 3, "update": 2.2, "loss": "2356.15", "ntokens": "20347.7", "nsentences": "108.68", "nll_loss": "12.584", "wps": "9448.6", "ups": "0.46", "wpb": "20347.7", "bsz": "108.7", "num_updates": "50", "lr": "3.475e-06", "gnorm": "1229.64", "loss_scale": "4", "train_wall": "106", "gb_free": "10.6", "wall": "132"}
[2024-04-23 21:33:47,889][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:33:47,892][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:33:48,440][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 8
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:33:50,639][valid][INFO] - {"epoch": 3, "valid_loss": "2521.71", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "12.216", "valid_uer": "118.133", "valid_wer": "101.809", "valid_raw_wer": "100", "valid_wps": "1758.6", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "70"}
[2024-04-23 21:33:50,641][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.809]
[2024-04-23 21:33:50,642][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:33:50,644][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:33:51,164][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 9
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:33:53,226][valid][INFO] - {"epoch": 3, "valid_loss": "2416.22", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.705", "valid_uer": "103.407", "valid_wer": "101.034", "valid_raw_wer": "100", "valid_wps": "1825.6", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "70"}
[2024-04-23 21:33:53,227][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [101.034]
[2024-04-23 21:33:53,228][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:33:53,229][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:33:53,792][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 10
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:33:55,877][valid][INFO] - {"epoch": 3, "valid_loss": "2477.07", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.999", "valid_uer": "112.772", "valid_wer": "101.723", "valid_raw_wer": "100", "valid_wps": "1817", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "70"}
[2024-04-23 21:33:55,878][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [101.723]
[2024-04-23 21:33:55,879][fairseq_cli.train][INFO] - end of epoch 3 (average epoch stats below)
[2024-04-23 21:33:55,879][train][INFO] - {"epoch": 3, "train_loss": "2340.11", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "12.554", "train_wps": "9983.7", "train_ups": "0.49", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "70", "train_lr": "4.465e-06", "train_gnorm": "1262.46", "train_loss_scale": "4", "train_train_wall": "41", "train_gb_free": "10.6", "train_wall": "173"}
[2024-04-23 21:33:55,883][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:33:56,634][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 4
[2024-04-23 21:33:56,718][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:33:56,770][fairseq.trainer][INFO] - begin training epoch 4
[2024-04-23 21:33:56,784][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:34:40,126][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:34:40,128][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:34:40,640][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 11
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:34:42,869][valid][INFO] - {"epoch": 4, "valid_loss": "2514.66", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "12.181", "valid_uer": "118.133", "valid_wer": "101.809", "valid_raw_wer": "100", "valid_wps": "1628.9", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "95"}
[2024-04-23 21:34:42,870][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.809]
[2024-04-23 21:34:42,870][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:34:42,872][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:34:43,304][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 12
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:34:45,576][valid][INFO] - {"epoch": 4, "valid_loss": "2396.42", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.609", "valid_uer": "104.392", "valid_wer": "100.861", "valid_raw_wer": "100", "valid_wps": "1484.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "95"}
[2024-04-23 21:34:45,577][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.861]
[2024-04-23 21:34:45,577][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:34:45,580][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:34:46,072][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 13
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:34:48,243][valid][INFO] - {"epoch": 4, "valid_loss": "2466.01", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.946", "valid_uer": "111.917", "valid_wer": "101.55", "valid_raw_wer": "100", "valid_wps": "1619.7", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "95"}
[2024-04-23 21:34:48,244][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [101.55]
[2024-04-23 21:34:48,245][fairseq_cli.train][INFO] - end of epoch 4 (average epoch stats below)
[2024-04-23 21:34:48,245][train][INFO] - {"epoch": 4, "train_loss": "2334.85", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "12.526", "train_wps": "9703.8", "train_ups": "0.48", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "95", "train_lr": "5.7025e-06", "train_gnorm": "1230.92", "train_loss_scale": "4", "train_train_wall": "42", "train_gb_free": "10.6", "train_wall": "225"}
[2024-04-23 21:34:48,249][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:34:49,014][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 5
[2024-04-23 21:34:49,157][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:34:49,173][fairseq.trainer][INFO] - begin training epoch 5
[2024-04-23 21:34:49,173][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:34:59,580][train_inner][INFO] - {"epoch": 5, "update": 4.2, "loss": "2324.04", "ntokens": "20303.6", "nsentences": "109.58", "nll_loss": "12.543", "wps": "9764", "ups": "0.48", "wpb": "20303.6", "bsz": "109.6", "num_updates": "100", "lr": "5.95e-06", "gnorm": "1235.51", "loss_scale": "4", "train_wall": "83", "gb_free": "10.5", "wall": "236"}
[2024-04-23 21:35:32,342][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:35:32,344][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:35:32,836][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 14
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:35:35,155][valid][INFO] - {"epoch": 5, "valid_loss": "2505.75", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "12.138", "valid_uer": "117.956", "valid_wer": "101.981", "valid_raw_wer": "100", "valid_wps": "1523.9", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "120"}
[2024-04-23 21:35:35,157][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.981]
[2024-04-23 21:35:35,158][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:35:35,160][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:35:35,624][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 15
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:35:37,836][valid][INFO] - {"epoch": 5, "valid_loss": "2385.73", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.557", "valid_uer": "103.197", "valid_wer": "100.603", "valid_raw_wer": "100", "valid_wps": "1688", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "120"}
[2024-04-23 21:35:37,837][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.603]
[2024-04-23 21:35:37,838][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:35:37,840][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:35:38,364][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 16
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:35:40,534][valid][INFO] - {"epoch": 5, "valid_loss": "2457.17", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.903", "valid_uer": "111.255", "valid_wer": "102.412", "valid_raw_wer": "100", "valid_wps": "1632.8", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "120"}
[2024-04-23 21:35:40,536][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [102.412]
[2024-04-23 21:35:40,538][fairseq.checkpoint_utils][INFO] - Preparing to save checkpoint for epoch 5 @ 120 updates
[2024-04-23 21:35:40,542][fairseq.trainer][INFO] - Saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:35:44,494][fairseq.trainer][INFO] - Finished saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:35:48,748][fairseq.checkpoint_utils][INFO] - Saved checkpoint /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt (epoch 5 @ 120 updates, score 101.981) (writing took 8.210009156027809 seconds)
[2024-04-23 21:35:48,749][fairseq_cli.train][INFO] - end of epoch 5 (average epoch stats below)
[2024-04-23 21:35:48,750][train][INFO] - {"epoch": 5, "train_loss": "2326.25", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "12.48", "train_wps": "8398.4", "train_ups": "0.41", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "120", "train_lr": "6.94e-06", "train_gnorm": "1280.16", "train_loss_scale": "4", "train_train_wall": "41", "train_gb_free": "9.8", "train_wall": "285"}
[2024-04-23 21:35:48,754][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:35:49,161][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 6
[2024-04-23 21:35:49,208][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:35:49,215][fairseq.trainer][INFO] - begin training epoch 6
[2024-04-23 21:35:49,215][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:36:30,142][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:36:30,144][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:36:30,720][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 17
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:36:32,929][valid][INFO] - {"epoch": 6, "valid_loss": "2494.94", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "12.086", "valid_uer": "117.552", "valid_wer": "101.637", "valid_raw_wer": "100", "valid_wps": "1628.7", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "145", "valid_best_wer": "101.637"}
[2024-04-23 21:36:32,930][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.637]
[2024-04-23 21:36:32,931][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:36:32,933][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:36:33,549][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 18
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:36:35,644][valid][INFO] - {"epoch": 6, "valid_loss": "2364.95", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.456", "valid_uer": "102.567", "valid_wer": "100.517", "valid_raw_wer": "100", "valid_wps": "1894.7", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "145", "valid_best_wer": "100.517"}
[2024-04-23 21:36:35,646][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.517]
[2024-04-23 21:36:35,646][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:36:35,648][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:36:36,244][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 19
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:36:38,346][valid][INFO] - {"epoch": 6, "valid_loss": "2445.16", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.845", "valid_uer": "110.948", "valid_wer": "101.034", "valid_raw_wer": "100", "valid_wps": "1866.1", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "145", "valid_best_wer": "101.034"}
[2024-04-23 21:36:38,347][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [101.034]
[2024-04-23 21:36:38,348][fairseq_cli.train][INFO] - end of epoch 6 (average epoch stats below)
[2024-04-23 21:36:38,349][train][INFO] - {"epoch": 6, "train_loss": "2318.18", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "12.436", "train_wps": "10245.2", "train_ups": "0.5", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "145", "train_lr": "8.1775e-06", "train_gnorm": "1268.61", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.8", "train_wall": "335"}
[2024-04-23 21:36:38,353][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:36:39,069][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 7
[2024-04-23 21:36:39,191][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:36:39,204][fairseq.trainer][INFO] - begin training epoch 7
[2024-04-23 21:36:39,214][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:36:49,146][train_inner][INFO] - {"epoch": 7, "update": 6.2, "loss": "2315.74", "ntokens": "20336.8", "nsentences": "109.22", "nll_loss": "12.437", "wps": "9280.7", "ups": "0.46", "wpb": "20336.8", "bsz": "109.2", "num_updates": "150", "lr": "8.425e-06", "gnorm": "1282.69", "loss_scale": "4", "train_wall": "81", "gb_free": "9.7", "wall": "346"}
[2024-04-23 21:37:21,102][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:37:21,105][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:37:21,397][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 20
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:37:23,851][valid][INFO] - {"epoch": 7, "valid_loss": "2482.95", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "12.028", "valid_uer": "116.906", "valid_wer": "101.895", "valid_raw_wer": "100", "valid_wps": "1376.6", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "170", "valid_best_wer": "101.895"}
[2024-04-23 21:37:23,852][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.895]
[2024-04-23 21:37:23,853][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:37:23,855][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:37:24,286][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 21
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:37:26,492][valid][INFO] - {"epoch": 7, "valid_loss": "2352.41", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.396", "valid_uer": "102.777", "valid_wer": "100.775", "valid_raw_wer": "100", "valid_wps": "1602.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "170", "valid_best_wer": "100.775"}
[2024-04-23 21:37:26,494][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.775]
[2024-04-23 21:37:26,495][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:37:26,497][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:37:26,952][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 22
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:37:29,236][valid][INFO] - {"epoch": 7, "valid_loss": "2430.67", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.775", "valid_uer": "109.785", "valid_wer": "101.378", "valid_raw_wer": "100", "valid_wps": "1530", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "170", "valid_best_wer": "101.378"}
[2024-04-23 21:37:29,237][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [101.378]
[2024-04-23 21:37:29,238][fairseq_cli.train][INFO] - end of epoch 7 (average epoch stats below)
[2024-04-23 21:37:29,239][train][INFO] - {"epoch": 7, "train_loss": "2304.64", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "12.364", "train_wps": "9985.3", "train_ups": "0.49", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "170", "train_lr": "9.415e-06", "train_gnorm": "1269.9", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.7", "train_wall": "386"}
[2024-04-23 21:37:29,243][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:37:29,997][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 8
[2024-04-23 21:37:30,078][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:37:30,091][fairseq.trainer][INFO] - begin training epoch 8
[2024-04-23 21:37:30,091][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:38:11,219][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:38:11,221][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:38:11,720][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 23
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:38:14,022][valid][INFO] - {"epoch": 8, "valid_loss": "2468.69", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.959", "valid_uer": "116.357", "valid_wer": "101.55", "valid_raw_wer": "100", "valid_wps": "1554.9", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "195", "valid_best_wer": "101.55"}
[2024-04-23 21:38:14,024][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.55]
[2024-04-23 21:38:14,024][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:38:14,026][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:38:14,581][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 24
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:38:16,748][valid][INFO] - {"epoch": 8, "valid_loss": "2321.45", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.246", "valid_uer": "101.954", "valid_wer": "100.689", "valid_raw_wer": "100", "valid_wps": "1637.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "195", "valid_best_wer": "100.689"}
[2024-04-23 21:38:16,749][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.689]
[2024-04-23 21:38:16,750][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:38:16,752][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:38:17,321][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 25
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:38:19,453][valid][INFO] - {"epoch": 8, "valid_loss": "2414.93", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.698", "valid_uer": "109.155", "valid_wer": "101.206", "valid_raw_wer": "100", "valid_wps": "1718.9", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "195", "valid_best_wer": "101.206"}
[2024-04-23 21:38:19,454][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [101.206]
[2024-04-23 21:38:19,455][fairseq_cli.train][INFO] - end of epoch 8 (average epoch stats below)
[2024-04-23 21:38:19,455][train][INFO] - {"epoch": 8, "train_loss": "2291.99", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "12.296", "train_wps": "10119.1", "train_ups": "0.5", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "195", "train_lr": "1.06525e-05", "train_gnorm": "1307.3", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.7", "train_wall": "436"}
[2024-04-23 21:38:19,459][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:38:20,133][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 9
[2024-04-23 21:38:20,231][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:38:20,246][fairseq.trainer][INFO] - begin training epoch 9
[2024-04-23 21:38:20,247][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:38:29,723][train_inner][INFO] - {"epoch": 9, "update": 8.2, "loss": "2307.2", "ntokens": "20278.7", "nsentences": "108.38", "nll_loss": "12.331", "wps": "10084.1", "ups": "0.5", "wpb": "20278.7", "bsz": "108.4", "num_updates": "200", "lr": "1.09e-05", "gnorm": "1285.31", "loss_scale": "4", "train_wall": "80", "gb_free": "9.7", "wall": "446"}
[2024-04-23 21:39:01,874][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:39:01,876][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:39:02,480][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 26
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:39:04,633][valid][INFO] - {"epoch": 9, "valid_loss": "2452.68", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.881", "valid_uer": "115.824", "valid_wer": "101.464", "valid_raw_wer": "100", "valid_wps": "1834", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "220", "valid_best_wer": "101.464"}
[2024-04-23 21:39:04,635][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.464]
[2024-04-23 21:39:04,636][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:39:04,638][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:39:05,228][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 27
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:39:07,267][valid][INFO] - {"epoch": 9, "valid_loss": "2292.64", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.106", "valid_uer": "100", "valid_wer": "100.345", "valid_raw_wer": "99.914", "valid_wps": "1821.5", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "220", "valid_best_wer": "100.345"}
[2024-04-23 21:39:07,269][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.345]
[2024-04-23 21:39:07,269][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:39:07,271][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:39:07,865][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 28
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:39:10,008][valid][INFO] - {"epoch": 9, "valid_loss": "2398.86", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.62", "valid_uer": "108.445", "valid_wer": "100.947", "valid_raw_wer": "100", "valid_wps": "1734.3", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "220", "valid_best_wer": "100.947"}
[2024-04-23 21:39:10,010][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.947]
[2024-04-23 21:39:10,010][fairseq_cli.train][INFO] - end of epoch 9 (average epoch stats below)
[2024-04-23 21:39:10,011][train][INFO] - {"epoch": 9, "train_loss": "2280.84", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "12.236", "train_wps": "10051.2", "train_ups": "0.49", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "220", "train_lr": "1.189e-05", "train_gnorm": "1281.86", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.7", "train_wall": "487"}
[2024-04-23 21:39:10,015][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:39:10,736][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 10
[2024-04-23 21:39:10,886][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:39:10,900][fairseq.trainer][INFO] - begin training epoch 10
[2024-04-23 21:39:10,901][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:39:51,673][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:39:51,675][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:39:52,176][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 29
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:39:54,456][valid][INFO] - {"epoch": 10, "valid_loss": "2434.7", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.794", "valid_uer": "115.227", "valid_wer": "101.292", "valid_raw_wer": "100", "valid_wps": "1652.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "245", "valid_best_wer": "101.292"}
[2024-04-23 21:39:54,457][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.292]
[2024-04-23 21:39:54,458][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:39:54,460][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:39:55,036][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 30
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:39:57,142][valid][INFO] - {"epoch": 10, "valid_loss": "2256.11", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.929", "valid_uer": "99.612", "valid_wer": "100.517", "valid_raw_wer": "100", "valid_wps": "1740", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "245", "valid_best_wer": "100.517"}
[2024-04-23 21:39:57,144][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.517]
[2024-04-23 21:39:57,144][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:39:57,146][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:39:57,752][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 31
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:40:00,428][valid][INFO] - {"epoch": 10, "valid_loss": "2378.94", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.524", "valid_uer": "107.993", "valid_wer": "100.947", "valid_raw_wer": "100", "valid_wps": "1526.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "245", "valid_best_wer": "100.947"}
[2024-04-23 21:40:00,429][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.947]
[2024-04-23 21:40:00,432][fairseq.checkpoint_utils][INFO] - Preparing to save checkpoint for epoch 10 @ 245 updates
[2024-04-23 21:40:00,434][fairseq.trainer][INFO] - Saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:40:04,707][fairseq.trainer][INFO] - Finished saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:40:08,890][fairseq.checkpoint_utils][INFO] - Saved checkpoint /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt (epoch 10 @ 245 updates, score 101.292) (writing took 8.457715315977111 seconds)
[2024-04-23 21:40:08,890][fairseq_cli.train][INFO] - end of epoch 10 (average epoch stats below)
[2024-04-23 21:40:08,892][train][INFO] - {"epoch": 10, "train_loss": "2257.02", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "12.108", "train_wps": "8630.1", "train_ups": "0.42", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "245", "train_lr": "1.31275e-05", "train_gnorm": "1352.47", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.8", "train_wall": "546"}
[2024-04-23 21:40:08,896][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:40:09,399][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 11
[2024-04-23 21:40:09,462][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:40:09,474][fairseq.trainer][INFO] - begin training epoch 11
[2024-04-23 21:40:09,475][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:40:18,400][train_inner][INFO] - {"epoch": 11, "update": 10.2, "loss": "2269.02", "ntokens": "20360.4", "nsentences": "108.92", "nll_loss": "12.138", "wps": "9367.5", "ups": "0.46", "wpb": "20360.4", "bsz": "108.9", "num_updates": "250", "lr": "1.3375e-05", "gnorm": "1334.02", "loss_scale": "4", "train_wall": "79", "gb_free": "9.7", "wall": "555"}
[2024-04-23 21:40:50,191][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:40:50,194][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:40:50,738][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 32
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:40:52,920][valid][INFO] - {"epoch": 11, "valid_loss": "2415.54", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.701", "valid_uer": "114.71", "valid_wer": "101.464", "valid_raw_wer": "100", "valid_wps": "1824.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "270", "valid_best_wer": "101.292"}
[2024-04-23 21:40:52,922][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.464]
[2024-04-23 21:40:52,922][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:40:52,924][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:40:53,416][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 33
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:40:55,674][valid][INFO] - {"epoch": 11, "valid_loss": "2226.2", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.784", "valid_uer": "97.077", "valid_wer": "100.517", "valid_raw_wer": "100", "valid_wps": "1592.5", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "270", "valid_best_wer": "100.517"}
[2024-04-23 21:40:55,676][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.517]
[2024-04-23 21:40:55,677][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:40:55,679][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:40:56,260][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 34
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:40:58,329][valid][INFO] - {"epoch": 11, "valid_loss": "2355.54", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.411", "valid_uer": "107.218", "valid_wer": "100.431", "valid_raw_wer": "100", "valid_wps": "1838.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "270", "valid_best_wer": "100.431"}
[2024-04-23 21:40:58,331][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.431]
[2024-04-23 21:40:58,332][fairseq_cli.train][INFO] - end of epoch 11 (average epoch stats below)
[2024-04-23 21:40:58,332][train][INFO] - {"epoch": 11, "train_loss": "2242.93", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "12.033", "train_wps": "10277.9", "train_ups": "0.51", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "270", "train_lr": "1.4365e-05", "train_gnorm": "1356.26", "train_loss_scale": "4", "train_train_wall": "39", "train_gb_free": "9.8", "train_wall": "595"}
[2024-04-23 21:40:58,336][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:40:59,017][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 12
[2024-04-23 21:40:59,160][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:40:59,185][fairseq.trainer][INFO] - begin training epoch 12
[2024-04-23 21:40:59,200][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:41:40,466][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:41:40,468][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:41:40,996][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 35
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:41:43,273][valid][INFO] - {"epoch": 12, "valid_loss": "2394.47", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.599", "valid_uer": "113.321", "valid_wer": "101.464", "valid_raw_wer": "100", "valid_wps": "1709.6", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "295", "valid_best_wer": "101.292"}
[2024-04-23 21:41:43,276][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.464]
[2024-04-23 21:41:43,276][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:41:43,278][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:41:43,856][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 36
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:41:45,988][valid][INFO] - {"epoch": 12, "valid_loss": "2193.65", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.626", "valid_uer": "95.656", "valid_wer": "100.431", "valid_raw_wer": "100", "valid_wps": "1710.5", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "295", "valid_best_wer": "100.431"}
[2024-04-23 21:41:45,990][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.431]
[2024-04-23 21:41:45,990][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:41:45,992][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:41:46,488][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 37
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:41:48,759][valid][INFO] - {"epoch": 12, "valid_loss": "2329.86", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.286", "valid_uer": "105.587", "valid_wer": "101.12", "valid_raw_wer": "100", "valid_wps": "1574.5", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "295", "valid_best_wer": "101.12"}
[2024-04-23 21:41:48,761][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [101.12]
[2024-04-23 21:41:48,762][fairseq_cli.train][INFO] - end of epoch 12 (average epoch stats below)
[2024-04-23 21:41:48,762][train][INFO] - {"epoch": 12, "train_loss": "2225.13", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "11.937", "train_wps": "10076.4", "train_ups": "0.5", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "295", "train_lr": "1.56025e-05", "train_gnorm": "1347.38", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.8", "train_wall": "645"}
[2024-04-23 21:41:48,767][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:41:49,421][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 13
[2024-04-23 21:41:49,512][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:41:49,524][fairseq.trainer][INFO] - begin training epoch 13
[2024-04-23 21:41:49,525][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:41:58,839][train_inner][INFO] - {"epoch": 13, "update": 12.2, "loss": "2230.76", "ntokens": "20332.7", "nsentences": "109.06", "nll_loss": "11.965", "wps": "10122.1", "ups": "0.5", "wpb": "20332.7", "bsz": "109.1", "num_updates": "300", "lr": "1.585e-05", "gnorm": "1355.54", "loss_scale": "4", "train_wall": "80", "gb_free": "9.7", "wall": "656"}
[2024-04-23 21:42:30,129][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:42:30,132][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:42:30,640][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 38
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:42:32,961][valid][INFO] - {"epoch": 13, "valid_loss": "2371.12", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.486", "valid_uer": "112.304", "valid_wer": "101.464", "valid_raw_wer": "100", "valid_wps": "1605.7", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "320", "valid_best_wer": "101.292"}
[2024-04-23 21:42:32,963][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.464]
[2024-04-23 21:42:32,963][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:42:32,965][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:42:33,461][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 39
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:42:35,720][valid][INFO] - {"epoch": 13, "valid_loss": "2150.81", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.419", "valid_uer": "94.833", "valid_wer": "100.172", "valid_raw_wer": "100", "valid_wps": "1601.6", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "320", "valid_best_wer": "100.172"}
[2024-04-23 21:42:35,722][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.172]
[2024-04-23 21:42:35,722][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:42:35,724][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:42:36,244][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 40
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:42:38,557][valid][INFO] - {"epoch": 13, "valid_loss": "2305.78", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.17", "valid_uer": "103.698", "valid_wer": "101.12", "valid_raw_wer": "100", "valid_wps": "1539.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "320", "valid_best_wer": "101.12"}
[2024-04-23 21:42:38,559][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [101.12]
[2024-04-23 21:42:38,560][fairseq_cli.train][INFO] - end of epoch 13 (average epoch stats below)
[2024-04-23 21:42:38,561][train][INFO] - {"epoch": 13, "train_loss": "2198.76", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "11.796", "train_wps": "10204.1", "train_ups": "0.5", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "320", "train_lr": "1.684e-05", "train_gnorm": "1400.67", "train_loss_scale": "4", "train_train_wall": "39", "train_gb_free": "9.7", "train_wall": "695"}
[2024-04-23 21:42:38,565][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:42:39,233][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 14
[2024-04-23 21:42:39,361][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:42:39,377][fairseq.trainer][INFO] - begin training epoch 14
[2024-04-23 21:42:39,377][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:43:20,442][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:43:20,444][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:43:21,032][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 41
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:43:23,239][valid][INFO] - {"epoch": 14, "valid_loss": "2346.1", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.365", "valid_uer": "110.932", "valid_wer": "101.895", "valid_raw_wer": "100", "valid_wps": "1751.3", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "345", "valid_best_wer": "101.292"}
[2024-04-23 21:43:23,241][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.895]
[2024-04-23 21:43:23,242][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:43:23,244][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:43:23,765][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 42
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:43:25,916][valid][INFO] - {"epoch": 14, "valid_loss": "2107.99", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.211", "valid_uer": "93.154", "valid_wer": "100.172", "valid_raw_wer": "100", "valid_wps": "1785.8", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "345", "valid_best_wer": "100.172"}
[2024-04-23 21:43:25,918][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.172]
[2024-04-23 21:43:25,919][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:43:25,920][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:43:26,369][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 43
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:43:28,662][valid][INFO] - {"epoch": 14, "valid_loss": "2277.3", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.032", "valid_uer": "102.358", "valid_wer": "100.345", "valid_raw_wer": "100", "valid_wps": "1658.8", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "345", "valid_best_wer": "100.345"}
[2024-04-23 21:43:28,663][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.345]
[2024-04-23 21:43:28,664][fairseq_cli.train][INFO] - end of epoch 14 (average epoch stats below)
[2024-04-23 21:43:28,665][train][INFO] - {"epoch": 14, "train_loss": "2176.67", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "11.677", "train_wps": "10141.9", "train_ups": "0.5", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "345", "train_lr": "1.80775e-05", "train_gnorm": "1385.92", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.8", "train_wall": "745"}
[2024-04-23 21:43:28,669][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:43:29,237][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 15
[2024-04-23 21:43:29,311][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:43:29,322][fairseq.trainer][INFO] - begin training epoch 15
[2024-04-23 21:43:29,322][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:43:39,373][train_inner][INFO] - {"epoch": 15, "update": 14.2, "loss": "2178.37", "ntokens": "20358.9", "nsentences": "109.36", "nll_loss": "11.701", "wps": "10127.1", "ups": "0.5", "wpb": "20358.9", "bsz": "109.4", "num_updates": "350", "lr": "1.8325e-05", "gnorm": "1387.42", "loss_scale": "4", "train_wall": "80", "gb_free": "9.7", "wall": "756"}
[2024-04-23 21:44:11,500][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:44:11,502][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:44:12,023][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 44
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:44:14,307][valid][INFO] - {"epoch": 15, "valid_loss": "2320.03", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.239", "valid_uer": "109.705", "valid_wer": "101.206", "valid_raw_wer": "100", "valid_wps": "1664.3", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "370", "valid_best_wer": "101.206"}
[2024-04-23 21:44:14,309][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.206]
[2024-04-23 21:44:14,310][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:44:14,312][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:44:14,816][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 45
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:44:17,076][valid][INFO] - {"epoch": 15, "valid_loss": "2069.59", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.025", "valid_uer": "90.877", "valid_wer": "100.345", "valid_raw_wer": "99.914", "valid_wps": "1591.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "370", "valid_best_wer": "100.345"}
[2024-04-23 21:44:17,077][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.345]
[2024-04-23 21:44:17,078][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:44:17,080][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:44:17,710][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 46
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:44:19,785][valid][INFO] - {"epoch": 15, "valid_loss": "2249.36", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.896", "valid_uer": "101.211", "valid_wer": "100.603", "valid_raw_wer": "100", "valid_wps": "1757.8", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "370", "valid_best_wer": "100.603"}
[2024-04-23 21:44:19,787][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.603]
[2024-04-23 21:44:19,789][fairseq.checkpoint_utils][INFO] - Preparing to save checkpoint for epoch 15 @ 370 updates
[2024-04-23 21:44:19,792][fairseq.trainer][INFO] - Saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:44:24,495][fairseq.trainer][INFO] - Finished saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:44:28,676][fairseq.checkpoint_utils][INFO] - Saved checkpoint /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt (epoch 15 @ 370 updates, score 101.206) (writing took 8.887134967022575 seconds)
[2024-04-23 21:44:28,677][fairseq_cli.train][INFO] - end of epoch 15 (average epoch stats below)
[2024-04-23 21:44:28,678][train][INFO] - {"epoch": 15, "train_loss": "2157.32", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "11.574", "train_wps": "8467.2", "train_ups": "0.42", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "370", "train_lr": "1.9315e-05", "train_gnorm": "1344.93", "train_loss_scale": "4", "train_train_wall": "41", "train_gb_free": "9.8", "train_wall": "805"}
[2024-04-23 21:44:28,683][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:44:29,201][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 16
[2024-04-23 21:44:29,269][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:44:29,281][fairseq.trainer][INFO] - begin training epoch 16
[2024-04-23 21:44:29,281][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:45:10,179][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:45:10,188][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:45:10,764][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 47
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:45:12,994][valid][INFO] - {"epoch": 16, "valid_loss": "2292.07", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "11.103", "valid_uer": "107.848", "valid_wer": "101.034", "valid_raw_wer": "100", "valid_wps": "1716", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "395", "valid_best_wer": "101.034"}
[2024-04-23 21:45:12,996][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.034]
[2024-04-23 21:45:12,997][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:45:12,999][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:45:13,484][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 48
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:45:15,642][valid][INFO] - {"epoch": 16, "valid_loss": "2022.79", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.799", "valid_uer": "88.875", "valid_wer": "100.258", "valid_raw_wer": "100", "valid_wps": "1679.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "395", "valid_best_wer": "100.258"}
[2024-04-23 21:45:15,644][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.258]
[2024-04-23 21:45:15,645][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:45:15,646][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:45:16,176][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 49
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:45:18,369][valid][INFO] - {"epoch": 16, "valid_loss": "2214.88", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.729", "valid_uer": "99.403", "valid_wer": "100.258", "valid_raw_wer": "100", "valid_wps": "1644.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "395", "valid_best_wer": "100.258"}
[2024-04-23 21:45:18,371][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.258]
[2024-04-23 21:45:18,371][fairseq_cli.train][INFO] - end of epoch 16 (average epoch stats below)
[2024-04-23 21:45:18,372][train][INFO] - {"epoch": 16, "train_loss": "2129.82", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "11.426", "train_wps": "10225.7", "train_ups": "0.5", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "395", "train_lr": "2.05525e-05", "train_gnorm": "1358.96", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.8", "train_wall": "855"}
[2024-04-23 21:45:18,376][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:45:19,065][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 17
[2024-04-23 21:45:19,231][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:45:19,261][fairseq.trainer][INFO] - begin training epoch 17
[2024-04-23 21:45:19,272][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:45:28,730][train_inner][INFO] - {"epoch": 17, "update": 16.2, "loss": "2147.97", "ntokens": "20283", "nsentences": "108.38", "nll_loss": "11.477", "wps": "9275.3", "ups": "0.46", "wpb": "20283", "bsz": "108.4", "num_updates": "400", "lr": "2.08e-05", "gnorm": "1363.15", "loss_scale": "4", "train_wall": "80", "gb_free": "9.7", "wall": "865"}
[2024-04-23 21:46:00,736][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:46:00,739][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:46:01,269][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 50
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:46:03,602][valid][INFO] - {"epoch": 17, "valid_loss": "2261.44", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.955", "valid_uer": "105.732", "valid_wer": "101.034", "valid_raw_wer": "100", "valid_wps": "1574.1", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "420", "valid_best_wer": "101.034"}
[2024-04-23 21:46:03,604][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [101.034]
[2024-04-23 21:46:03,604][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:46:03,606][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:46:04,000][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 51
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:46:06,469][valid][INFO] - {"epoch": 17, "valid_loss": "1972.65", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.556", "valid_uer": "87.873", "valid_wer": "99.914", "valid_raw_wer": "99.914", "valid_wps": "1527.7", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "420", "valid_best_wer": "99.914"}
[2024-04-23 21:46:06,472][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [99.914]
[2024-04-23 21:46:06,472][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:46:06,474][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:46:07,054][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 52
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:46:09,327][valid][INFO] - {"epoch": 17, "valid_loss": "2183.17", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.576", "valid_uer": "97.949", "valid_wer": "100.258", "valid_raw_wer": "100", "valid_wps": "1592", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "420", "valid_best_wer": "100.258"}
[2024-04-23 21:46:09,330][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.258]
[2024-04-23 21:46:09,330][fairseq_cli.train][INFO] - end of epoch 17 (average epoch stats below)
[2024-04-23 21:46:09,331][train][INFO] - {"epoch": 17, "train_loss": "2093.57", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "11.231", "train_wps": "9971.8", "train_ups": "0.49", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "420", "train_lr": "2.179e-05", "train_gnorm": "1410.43", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.9", "train_wall": "906"}
[2024-04-23 21:46:09,335][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:46:10,097][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 18
[2024-04-23 21:46:10,243][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:46:10,278][fairseq.trainer][INFO] - begin training epoch 18
[2024-04-23 21:46:10,290][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:46:51,306][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:46:51,308][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:46:51,818][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 53
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:46:54,244][valid][INFO] - {"epoch": 18, "valid_loss": "2229.9", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.802", "valid_uer": "103.213", "valid_wer": "100.775", "valid_raw_wer": "100", "valid_wps": "1515", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "445", "valid_best_wer": "100.775"}
[2024-04-23 21:46:54,246][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [100.775]
[2024-04-23 21:46:54,247][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:46:54,249][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:46:54,856][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 54
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:46:57,000][valid][INFO] - {"epoch": 18, "valid_loss": "1926.78", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.334", "valid_uer": "86.162", "valid_wer": "100", "valid_raw_wer": "99.914", "valid_wps": "1674.5", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "445", "valid_best_wer": "100"}
[2024-04-23 21:46:57,002][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.0]
[2024-04-23 21:46:57,002][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:46:57,004][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:46:57,632][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 55
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:46:59,858][valid][INFO] - {"epoch": 18, "valid_loss": "2148.54", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.408", "valid_uer": "96.06", "valid_wer": "100.086", "valid_raw_wer": "100", "valid_wps": "1709.3", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "445", "valid_best_wer": "100.086"}
[2024-04-23 21:46:59,860][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.086]
[2024-04-23 21:46:59,861][fairseq_cli.train][INFO] - end of epoch 18 (average epoch stats below)
[2024-04-23 21:46:59,862][train][INFO] - {"epoch": 18, "train_loss": "2075.18", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "11.133", "train_wps": "10056.2", "train_ups": "0.49", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "445", "train_lr": "2.30275e-05", "train_gnorm": "1369.74", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.7", "train_wall": "957"}
[2024-04-23 21:46:59,866][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:47:00,513][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 19
[2024-04-23 21:47:00,636][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:47:00,649][fairseq.trainer][INFO] - begin training epoch 19
[2024-04-23 21:47:00,650][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:47:10,363][train_inner][INFO] - {"epoch": 19, "update": 18.2, "loss": "2078.32", "ntokens": "20317.2", "nsentences": "109.22", "nll_loss": "11.173", "wps": "9999.6", "ups": "0.49", "wpb": "20317.2", "bsz": "109.2", "num_updates": "450", "lr": "2.3275e-05", "gnorm": "1372.92", "loss_scale": "4", "train_wall": "80", "gb_free": "9.8", "wall": "967"}
[2024-04-23 21:47:41,934][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:47:41,936][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:47:42,491][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 56
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:47:44,809][valid][INFO] - {"epoch": 19, "valid_loss": "2197.57", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.645", "valid_uer": "100.904", "valid_wer": "100.603", "valid_raw_wer": "100", "valid_wps": "1591.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "470", "valid_best_wer": "100.603"}
[2024-04-23 21:47:44,811][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [100.603]
[2024-04-23 21:47:44,812][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:47:44,814][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:47:45,329][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 57
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:47:47,552][valid][INFO] - {"epoch": 19, "valid_loss": "1880.82", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.111", "valid_uer": "84.337", "valid_wer": "100", "valid_raw_wer": "99.914", "valid_wps": "1572", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "470", "valid_best_wer": "100"}
[2024-04-23 21:47:47,554][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.0]
[2024-04-23 21:47:47,555][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:47:47,557][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:47:48,103][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 58
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:47:50,297][valid][INFO] - {"epoch": 19, "valid_loss": "2113.61", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.239", "valid_uer": "93.912", "valid_wer": "100", "valid_raw_wer": "100", "valid_wps": "1770.9", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "470", "valid_best_wer": "100"}
[2024-04-23 21:47:50,299][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:47:50,299][fairseq_cli.train][INFO] - end of epoch 19 (average epoch stats below)
[2024-04-23 21:47:50,300][train][INFO] - {"epoch": 19, "train_loss": "2050.8", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "11.002", "train_wps": "10074.8", "train_ups": "0.5", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "470", "train_lr": "2.4265e-05", "train_gnorm": "1284.03", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.7", "train_wall": "1007"}
[2024-04-23 21:47:50,304][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:47:50,953][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 20
[2024-04-23 21:47:51,153][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:47:51,164][fairseq.trainer][INFO] - begin training epoch 20
[2024-04-23 21:47:51,181][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:48:31,962][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:48:31,965][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:48:32,472][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 59
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:48:34,934][valid][INFO] - {"epoch": 20, "valid_loss": "2163.1", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.478", "valid_uer": "98.127", "valid_wer": "100.258", "valid_raw_wer": "100", "valid_wps": "1384.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "495", "valid_best_wer": "100.258"}
[2024-04-23 21:48:34,937][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [100.258]
[2024-04-23 21:48:34,937][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:48:34,939][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:48:35,464][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 60
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:48:37,662][valid][INFO] - {"epoch": 20, "valid_loss": "1825.78", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.844", "valid_uer": "83.336", "valid_wer": "99.914", "valid_raw_wer": "99.742", "valid_wps": "1672.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "495", "valid_best_wer": "99.914"}
[2024-04-23 21:48:37,664][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [99.914]
[2024-04-23 21:48:37,665][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:48:37,667][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:48:38,204][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 61
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:48:40,459][valid][INFO] - {"epoch": 20, "valid_loss": "2073.33", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.044", "valid_uer": "91.668", "valid_wer": "100", "valid_raw_wer": "99.914", "valid_wps": "1752.8", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "495", "valid_best_wer": "100"}
[2024-04-23 21:48:40,460][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:48:40,463][fairseq.checkpoint_utils][INFO] - Preparing to save checkpoint for epoch 20 @ 495 updates
[2024-04-23 21:48:40,465][fairseq.trainer][INFO] - Saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:48:44,502][fairseq.trainer][INFO] - Finished saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:48:48,804][fairseq.checkpoint_utils][INFO] - Saved checkpoint /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt (epoch 20 @ 495 updates, score 100.258) (writing took 8.340917814988643 seconds)
[2024-04-23 21:48:48,805][fairseq_cli.train][INFO] - end of epoch 20 (average epoch stats below)
[2024-04-23 21:48:48,806][train][INFO] - {"epoch": 20, "train_loss": "2003.05", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "10.746", "train_wps": "8685.5", "train_ups": "0.43", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "495", "train_lr": "2.55025e-05", "train_gnorm": "1346.52", "train_loss_scale": "4", "train_train_wall": "39", "train_gb_free": "9.8", "train_wall": "1065"}
[2024-04-23 21:48:48,810][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:48:49,321][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 21
[2024-04-23 21:48:49,395][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:48:49,406][fairseq.trainer][INFO] - begin training epoch 21
[2024-04-23 21:48:49,406][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:48:57,771][train_inner][INFO] - {"epoch": 21, "update": 20.2, "loss": "2002.02", "ntokens": "20333", "nsentences": "110.1", "nll_loss": "10.841", "wps": "9469.4", "ups": "0.47", "wpb": "20333", "bsz": "110.1", "num_updates": "500", "lr": "2.575e-05", "gnorm": "1293.96", "loss_scale": "4", "train_wall": "78", "gb_free": "9.8", "wall": "1074"}
[2024-04-23 21:49:30,138][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:49:30,141][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:49:30,719][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 62
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:49:33,073][valid][INFO] - {"epoch": 21, "valid_loss": "2127.58", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.306", "valid_uer": "95.446", "valid_wer": "100.775", "valid_raw_wer": "99.914", "valid_wps": "1592.4", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "520", "valid_best_wer": "100.258"}
[2024-04-23 21:49:33,076][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [100.775]
[2024-04-23 21:49:33,077][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:49:33,079][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:49:33,636][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 63
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:49:35,780][valid][INFO] - {"epoch": 21, "valid_loss": "1785.39", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.649", "valid_uer": "82.012", "valid_wer": "100", "valid_raw_wer": "99.914", "valid_wps": "1673.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "520", "valid_best_wer": "100"}
[2024-04-23 21:49:35,782][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.0]
[2024-04-23 21:49:35,782][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:49:35,784][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:49:36,238][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 64
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:49:38,655][valid][INFO] - {"epoch": 21, "valid_loss": "2033.88", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.852", "valid_uer": "89.311", "valid_wer": "100", "valid_raw_wer": "100", "valid_wps": "1414.1", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "520", "valid_best_wer": "100"}
[2024-04-23 21:49:38,657][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:49:38,657][fairseq_cli.train][INFO] - end of epoch 21 (average epoch stats below)
[2024-04-23 21:49:38,658][train][INFO] - {"epoch": 21, "train_loss": "1986.22", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "10.656", "train_wps": "10193.2", "train_ups": "0.5", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "520", "train_lr": "2.674e-05", "train_gnorm": "1274.64", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.7", "train_wall": "1115"}
[2024-04-23 21:49:38,663][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:49:39,385][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 22
[2024-04-23 21:49:39,479][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:49:39,490][fairseq.trainer][INFO] - begin training epoch 22
[2024-04-23 21:49:39,491][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:50:20,641][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:50:20,644][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:50:21,088][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 65
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:50:23,556][valid][INFO] - {"epoch": 22, "valid_loss": "2089.52", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "10.122", "valid_uer": "92.653", "valid_wer": "100.431", "valid_raw_wer": "99.914", "valid_wps": "1464.4", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "545", "valid_best_wer": "100.258"}
[2024-04-23 21:50:23,558][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [100.431]
[2024-04-23 21:50:23,559][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:50:23,561][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:50:24,108][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 66
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:50:26,384][valid][INFO] - {"epoch": 22, "valid_loss": "1740.01", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.429", "valid_uer": "81.172", "valid_wer": "100", "valid_raw_wer": "99.914", "valid_wps": "1543.3", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "545", "valid_best_wer": "100"}
[2024-04-23 21:50:26,387][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.0]
[2024-04-23 21:50:26,387][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:50:26,389][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:50:26,900][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 67
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:50:29,249][valid][INFO] - {"epoch": 22, "valid_loss": "1993.04", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.655", "valid_uer": "87.195", "valid_wer": "100", "valid_raw_wer": "99.914", "valid_wps": "1588.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "545", "valid_best_wer": "100"}
[2024-04-23 21:50:29,251][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:50:29,252][fairseq_cli.train][INFO] - end of epoch 22 (average epoch stats below)
[2024-04-23 21:50:29,252][train][INFO] - {"epoch": 22, "train_loss": "1952.79", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "10.476", "train_wps": "10043.7", "train_ups": "0.49", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "545", "train_lr": "2.79775e-05", "train_gnorm": "1276.27", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.8", "train_wall": "1166"}
[2024-04-23 21:50:29,257][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:50:30,009][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 23
[2024-04-23 21:50:30,110][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:50:30,125][fairseq.trainer][INFO] - begin training epoch 23
[2024-04-23 21:50:30,125][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:50:39,557][train_inner][INFO] - {"epoch": 23, "update": 22.2, "loss": "1969.16", "ntokens": "20319.7", "nsentences": "108.34", "nll_loss": "10.499", "wps": "9984", "ups": "0.49", "wpb": "20319.7", "bsz": "108.3", "num_updates": "550", "lr": "2.8225e-05", "gnorm": "1298.67", "loss_scale": "4", "train_wall": "81", "gb_free": "9.8", "wall": "1176"}
[2024-04-23 21:51:11,177][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:51:11,179][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:51:11,588][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 68
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:51:14,075][valid][INFO] - {"epoch": 23, "valid_loss": "2050.95", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.935", "valid_uer": "90.053", "valid_wer": "100", "valid_raw_wer": "99.914", "valid_wps": "1382.6", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "570", "valid_best_wer": "100"}
[2024-04-23 21:51:14,078][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [100.0]
[2024-04-23 21:51:14,079][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:51:14,081][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:51:14,518][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 69
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:51:16,878][valid][INFO] - {"epoch": 23, "valid_loss": "1697.58", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.223", "valid_uer": "80.559", "valid_wer": "100", "valid_raw_wer": "99.828", "valid_wps": "1567.3", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "570", "valid_best_wer": "100"}
[2024-04-23 21:51:16,881][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.0]
[2024-04-23 21:51:16,881][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:51:16,883][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:51:17,487][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 70
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:51:19,802][valid][INFO] - {"epoch": 23, "valid_loss": "1953.84", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.465", "valid_uer": "85.064", "valid_wer": "99.914", "valid_raw_wer": "100", "valid_wps": "1557.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "570", "valid_best_wer": "99.914"}
[2024-04-23 21:51:19,804][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [99.914]
[2024-04-23 21:51:19,805][fairseq_cli.train][INFO] - end of epoch 23 (average epoch stats below)
[2024-04-23 21:51:19,806][train][INFO] - {"epoch": 23, "train_loss": "1914.51", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "10.271", "train_wps": "10051.8", "train_ups": "0.49", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "570", "train_lr": "2.9215e-05", "train_gnorm": "1259.03", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.8", "train_wall": "1216"}
[2024-04-23 21:51:19,810][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:51:20,441][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 24
[2024-04-23 21:51:20,628][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:51:20,643][fairseq.trainer][INFO] - begin training epoch 24
[2024-04-23 21:51:20,644][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:52:01,384][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:52:01,386][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:52:01,828][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 71
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:52:04,347][valid][INFO] - {"epoch": 24, "valid_loss": "2011.71", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.745", "valid_uer": "87.615", "valid_wer": "99.914", "valid_raw_wer": "99.914", "valid_wps": "1509.1", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "595", "valid_best_wer": "99.914"}
[2024-04-23 21:52:04,350][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [99.914]
[2024-04-23 21:52:04,351][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:52:04,353][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:52:04,914][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 72
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:52:07,204][valid][INFO] - {"epoch": 24, "valid_loss": "1655.13", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.018", "valid_uer": "80.236", "valid_wer": "100", "valid_raw_wer": "99.828", "valid_wps": "1511.4", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "595", "valid_best_wer": "100"}
[2024-04-23 21:52:07,206][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.0]
[2024-04-23 21:52:07,207][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:52:07,209][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:52:07,804][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 73
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:52:10,110][valid][INFO] - {"epoch": 24, "valid_loss": "1912.62", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.265", "valid_uer": "83.417", "valid_wer": "100", "valid_raw_wer": "100", "valid_wps": "1558.1", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "595", "valid_best_wer": "100"}
[2024-04-23 21:52:10,112][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:52:10,114][fairseq_cli.train][INFO] - end of epoch 24 (average epoch stats below)
[2024-04-23 21:52:10,115][train][INFO] - {"epoch": 24, "train_loss": "1872.98", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "10.048", "train_wps": "10100.6", "train_ups": "0.5", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "595", "train_lr": "3.04525e-05", "train_gnorm": "1247.57", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.9", "train_wall": "1267"}
[2024-04-23 21:52:10,119][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:52:10,829][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 25
[2024-04-23 21:52:10,917][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:52:10,930][fairseq.trainer][INFO] - begin training epoch 25
[2024-04-23 21:52:10,930][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:52:20,367][train_inner][INFO] - {"epoch": 25, "update": 24.2, "loss": "1891.98", "ntokens": "20350.1", "nsentences": "109.04", "nll_loss": "10.138", "wps": "10096.8", "ups": "0.5", "wpb": "20350.1", "bsz": "109", "num_updates": "600", "lr": "3.07e-05", "gnorm": "1242.33", "loss_scale": "4", "train_wall": "79", "gb_free": "9.7", "wall": "1277"}
[2024-04-23 21:52:51,584][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:52:51,586][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:52:52,152][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 74
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:52:54,474][valid][INFO] - {"epoch": 25, "valid_loss": "1972.88", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.557", "valid_uer": "85.451", "valid_wer": "99.914", "valid_raw_wer": "100", "valid_wps": "1581.8", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "620", "valid_best_wer": "99.914"}
[2024-04-23 21:52:54,477][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [99.914]
[2024-04-23 21:52:54,477][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:52:54,479][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:52:54,996][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 75
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:52:57,289][valid][INFO] - {"epoch": 25, "valid_loss": "1604.4", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "7.772", "valid_uer": "79.8", "valid_wer": "99.914", "valid_raw_wer": "99.655", "valid_wps": "1562.9", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "620", "valid_best_wer": "99.914"}
[2024-04-23 21:52:57,291][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [99.914]
[2024-04-23 21:52:57,292][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:52:57,294][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:52:57,744][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 76
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:53:00,250][valid][INFO] - {"epoch": 25, "valid_loss": "1874.32", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.08", "valid_uer": "81.77", "valid_wer": "100", "valid_raw_wer": "100", "valid_wps": "1374.5", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "620", "valid_best_wer": "100"}
[2024-04-23 21:53:00,252][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:53:00,255][fairseq.checkpoint_utils][INFO] - Preparing to save checkpoint for epoch 25 @ 620 updates
[2024-04-23 21:53:00,257][fairseq.trainer][INFO] - Saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:53:04,399][fairseq.trainer][INFO] - Finished saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:53:08,610][fairseq.checkpoint_utils][INFO] - Saved checkpoint /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt (epoch 25 @ 620 updates, score 99.914) (writing took 8.355222614947706 seconds)
[2024-04-23 21:53:08,612][fairseq_cli.train][INFO] - end of epoch 25 (average epoch stats below)
[2024-04-23 21:53:08,613][train][INFO] - {"epoch": 25, "train_loss": "1851.88", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "9.935", "train_wps": "8686.6", "train_ups": "0.43", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "620", "train_lr": "3.169e-05", "train_gnorm": "1181.07", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.9", "train_wall": "1325"}
[2024-04-23 21:53:08,619][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:53:09,061][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 26
[2024-04-23 21:53:09,144][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:53:09,156][fairseq.trainer][INFO] - begin training epoch 26
[2024-04-23 21:53:09,156][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:53:48,847][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:53:48,850][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:53:49,268][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 77
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:53:51,711][valid][INFO] - {"epoch": 26, "valid_loss": "1933.84", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.368", "valid_uer": "83.094", "valid_wer": "99.914", "valid_raw_wer": "100", "valid_wps": "1504.7", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "645", "valid_best_wer": "99.914"}
[2024-04-23 21:53:51,714][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [99.914]
[2024-04-23 21:53:51,714][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:53:51,716][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:53:52,138][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 78
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:53:54,504][valid][INFO] - {"epoch": 26, "valid_loss": "1570.95", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "7.61", "valid_uer": "79.751", "valid_wer": "100", "valid_raw_wer": "99.914", "valid_wps": "1550.1", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "645", "valid_best_wer": "99.914"}
[2024-04-23 21:53:54,507][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.0]
[2024-04-23 21:53:54,507][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:53:54,509][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:53:55,136][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 79
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:53:57,405][valid][INFO] - {"epoch": 26, "valid_loss": "1834.45", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.886", "valid_uer": "80.865", "valid_wer": "100", "valid_raw_wer": "100", "valid_wps": "1600.5", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "645", "valid_best_wer": "99.914"}
[2024-04-23 21:53:57,407][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:53:57,408][fairseq_cli.train][INFO] - end of epoch 26 (average epoch stats below)
[2024-04-23 21:53:57,408][train][INFO] - {"epoch": 26, "train_loss": "1820.66", "train_ntokens": "20325.4", "train_nsentences": "109.04", "train_nll_loss": "9.767", "train_wps": "10414.2", "train_ups": "0.51", "train_wpb": "20325.4", "train_bsz": "109", "train_num_updates": "645", "train_lr": "3.29275e-05", "train_gnorm": "1148.46", "train_loss_scale": "4", "train_train_wall": "39", "train_gb_free": "9.8", "train_wall": "1374"}
[2024-04-23 21:53:57,413][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:53:58,131][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 27
[2024-04-23 21:53:58,233][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:53:58,244][fairseq.trainer][INFO] - begin training epoch 27
[2024-04-23 21:53:58,245][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:54:07,779][train_inner][INFO] - {"epoch": 27, "update": 26.2, "loss": "1822.09", "ntokens": "20293.8", "nsentences": "109.28", "nll_loss": "9.812", "wps": "9450.1", "ups": "0.47", "wpb": "20293.8", "bsz": "109.3", "num_updates": "650", "lr": "3.3175e-05", "gnorm": "1155.35", "loss_scale": "4", "train_wall": "78", "gb_free": "9.7", "wall": "1384"}
[2024-04-23 21:54:40,171][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:54:40,176][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:54:40,752][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 80
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:54:43,154][valid][INFO] - {"epoch": 27, "valid_loss": "1895.38", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "9.182", "valid_uer": "81.447", "valid_wer": "99.914", "valid_raw_wer": "100", "valid_wps": "1504.9", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "670", "valid_best_wer": "99.914"}
[2024-04-23 21:54:43,157][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [99.914]
[2024-04-23 21:54:43,157][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:54:43,159][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:54:43,672][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 81
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:54:45,936][valid][INFO] - {"epoch": 27, "valid_loss": "1533.18", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "7.427", "valid_uer": "80.01", "valid_wer": "100", "valid_raw_wer": "100", "valid_wps": "1649.7", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "670", "valid_best_wer": "99.914"}
[2024-04-23 21:54:45,939][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.0]
[2024-04-23 21:54:45,939][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:54:45,941][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:54:46,460][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 82
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:54:48,812][valid][INFO] - {"epoch": 27, "valid_loss": "1797.3", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.706", "valid_uer": "79.477", "valid_wer": "100", "valid_raw_wer": "100", "valid_wps": "1557.3", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "670", "valid_best_wer": "99.914"}
[2024-04-23 21:54:48,815][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:54:48,815][fairseq_cli.train][INFO] - end of epoch 27 (average epoch stats below)
[2024-04-23 21:54:48,816][train][INFO] - {"epoch": 27, "train_loss": "1777.91", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "9.538", "train_wps": "9884.8", "train_ups": "0.49", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "670", "train_lr": "3.4165e-05", "train_gnorm": "1108.95", "train_loss_scale": "4", "train_train_wall": "41", "train_gb_free": "9.9", "train_wall": "1425"}
[2024-04-23 21:54:48,821][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:54:49,477][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 28
[2024-04-23 21:54:49,637][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:54:49,648][fairseq.trainer][INFO] - begin training epoch 28
[2024-04-23 21:54:49,649][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:55:30,843][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:55:30,846][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:55:31,316][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 83
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:55:33,872][valid][INFO] - {"epoch": 28, "valid_loss": "1856.62", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.994", "valid_uer": "80.074", "valid_wer": "99.828", "valid_raw_wer": "100", "valid_wps": "1538.5", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "695", "valid_best_wer": "99.828"}
[2024-04-23 21:55:33,875][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [99.828]
[2024-04-23 21:55:33,876][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:55:33,878][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:55:34,292][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 84
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:55:36,876][valid][INFO] - {"epoch": 28, "valid_loss": "1512.96", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "7.329", "valid_uer": "80.397", "valid_wer": "100", "valid_raw_wer": "99.828", "valid_wps": "1403.3", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "695", "valid_best_wer": "99.914"}
[2024-04-23 21:55:36,879][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.0]
[2024-04-23 21:55:36,880][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:55:36,882][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:55:37,468][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 85
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:55:39,965][valid][INFO] - {"epoch": 28, "valid_loss": "1759.92", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.525", "valid_uer": "78.75", "valid_wer": "100", "valid_raw_wer": "100.086", "valid_wps": "1503.7", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "695", "valid_best_wer": "99.914"}
[2024-04-23 21:55:39,968][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:55:39,968][fairseq_cli.train][INFO] - end of epoch 28 (average epoch stats below)
[2024-04-23 21:55:39,969][train][INFO] - {"epoch": 28, "train_loss": "1746.5", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "9.37", "train_wps": "9934", "train_ups": "0.49", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "695", "train_lr": "3.54025e-05", "train_gnorm": "1062.13", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.7", "train_wall": "1477"}
[2024-04-23 21:55:39,973][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:55:40,637][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 29
[2024-04-23 21:55:40,712][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:55:40,720][fairseq.trainer][INFO] - begin training epoch 29
[2024-04-23 21:55:40,720][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:55:50,276][train_inner][INFO] - {"epoch": 29, "update": 28.2, "loss": "1764.17", "ntokens": "20337.2", "nsentences": "108.7", "nll_loss": "9.429", "wps": "9921.6", "ups": "0.49", "wpb": "20337.2", "bsz": "108.7", "num_updates": "700", "lr": "3.565e-05", "gnorm": "1077.24", "loss_scale": "4", "train_wall": "81", "gb_free": "9.8", "wall": "1487"}
[2024-04-23 21:56:21,911][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:56:21,913][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:56:22,500][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 86
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:56:25,048][valid][INFO] - {"epoch": 29, "valid_loss": "1819.18", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.812", "valid_uer": "78.992", "valid_wer": "100", "valid_raw_wer": "100", "valid_wps": "1498.4", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "720", "valid_best_wer": "99.914"}
[2024-04-23 21:56:25,051][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [100.0]
[2024-04-23 21:56:25,052][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:56:25,054][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:56:25,560][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 87
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:56:28,095][valid][INFO] - {"epoch": 29, "valid_loss": "1475.53", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "7.148", "valid_uer": "80.769", "valid_wer": "100", "valid_raw_wer": "99.914", "valid_wps": "1427.2", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "720", "valid_best_wer": "99.914"}
[2024-04-23 21:56:28,099][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [100.0]
[2024-04-23 21:56:28,100][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:56:28,102][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:56:28,596][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 88
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:56:31,158][valid][INFO] - {"epoch": 29, "valid_loss": "1724.2", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.352", "valid_uer": "77.668", "valid_wer": "100", "valid_raw_wer": "99.914", "valid_wps": "1453.5", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "720", "valid_best_wer": "99.914"}
[2024-04-23 21:56:31,161][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:56:31,161][fairseq_cli.train][INFO] - end of epoch 29 (average epoch stats below)
[2024-04-23 21:56:31,162][train][INFO] - {"epoch": 29, "train_loss": "1724.54", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "9.252", "train_wps": "9926.1", "train_ups": "0.49", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "720", "train_lr": "3.664e-05", "train_gnorm": "1008.73", "train_loss_scale": "4", "train_train_wall": "40", "train_gb_free": "9.8", "train_wall": "1528"}
[2024-04-23 21:56:31,168][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:56:31,885][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 30
[2024-04-23 21:56:32,105][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:56:32,130][fairseq.trainer][INFO] - begin training epoch 30
[2024-04-23 21:56:32,136][fairseq_cli.train][INFO] - Start iterating over samples
[2024-04-23 21:57:14,189][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:57:14,191][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:57:14,740][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 89
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITHOUT NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:57:17,327][valid][INFO] - {"epoch": 30, "valid_loss": "1783", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.637", "valid_uer": "78.201", "valid_wer": "99.914", "valid_raw_wer": "100", "valid_wps": "1417.5", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "745", "valid_best_wer": "99.914"}
[2024-04-23 21:57:17,329][fairseq_cli.train][INFO] - Validation losses for noise type 'None': [99.914]
[2024-04-23 21:57:17,330][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:57:17,332][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:57:17,926][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 90
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH GAUSSIAN NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:57:20,319][valid][INFO] - {"epoch": 30, "valid_loss": "1452.56", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "7.036", "valid_uer": "80.849", "valid_wer": "99.914", "valid_raw_wer": "99.914", "valid_wps": "1495.6", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "745", "valid_best_wer": "99.914"}
[2024-04-23 21:57:20,322][fairseq_cli.train][INFO] - Validation losses for noise type 'gaussian': [99.914]
[2024-04-23 21:57:20,322][fairseq_cli.train][INFO] - begin validation on "valid" subset
[2024-04-23 21:57:20,325][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:57:20,828][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 91
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
VALID STEP WITH UNIFORM NOISE
EVAL STEP. CRITERION 
CtcCriterion()
[2024-04-23 21:57:23,410][valid][INFO] - {"epoch": 30, "valid_loss": "1684.85", "valid_ntokens": "3096.5", "valid_nsentences": "15", "valid_nll_loss": "8.162", "valid_uer": "77.119", "valid_wer": "100", "valid_raw_wer": "100", "valid_wps": "1457.7", "valid_wpb": "3096.5", "valid_bsz": "15", "valid_num_updates": "745", "valid_best_wer": "99.914"}
[2024-04-23 21:57:23,413][fairseq_cli.train][INFO] - Validation losses for noise type 'uniform': [100.0]
[2024-04-23 21:57:23,416][fairseq.checkpoint_utils][INFO] - Preparing to save checkpoint for epoch 30 @ 745 updates
[2024-04-23 21:57:23,419][fairseq.trainer][INFO] - Saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:57:28,317][fairseq.trainer][INFO] - Finished saving checkpoint to /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt
[2024-04-23 21:57:32,762][fairseq.checkpoint_utils][INFO] - Saved checkpoint /h/addisonw/fairseq/checkpoints/gaussianNoise/checkpoint_best.pt (epoch 30 @ 745 updates, score 99.914) (writing took 9.345439690048806 seconds)
[2024-04-23 21:57:32,763][fairseq_cli.train][INFO] - end of epoch 30 (average epoch stats below)
[2024-04-23 21:57:32,764][train][INFO] - {"epoch": 30, "train_loss": "1693.16", "train_ntokens": "20325.2", "train_nsentences": "109.04", "train_nll_loss": "9.083", "train_wps": "8249", "train_ups": "0.41", "train_wpb": "20325.2", "train_bsz": "109", "train_num_updates": "745", "train_lr": "3.78775e-05", "train_gnorm": "974.694", "train_loss_scale": "4", "train_train_wall": "41", "train_gb_free": "9.7", "train_wall": "1589"}
[2024-04-23 21:57:32,770][fairseq.tasks.fairseq_task][INFO] - can_reuse_epoch_itr = True
[2024-04-23 21:57:33,310][fairseq.tasks.fairseq_task][INFO] - creating new batches for epoch 31
[2024-04-23 21:57:33,392][fairseq.data.iterators][INFO] - grouped total_num_itrs = 25
[2024-04-23 21:57:33,407][fairseq.trainer][INFO] - begin training epoch 31
[2024-04-23 21:57:33,408][fairseq_cli.train][INFO] - Start iterating over samples
